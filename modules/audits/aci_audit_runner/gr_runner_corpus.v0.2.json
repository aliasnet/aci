{
  "$meta": {
    "artifact_id": "ArtifactID:BJkqri2Urq9mC8",
    "sha256": "45536b2ccb24e5f69c69f064681e3afb652ccbc995533002c8b57860d6220e5f",
    "issued": "2025-10-04T18:13:59Z",
    "path": "aci://modules/audits/aci_audit_runner/gr_runner_corpus.v0.2.json"
  },
  "corpus_id": "ACI-RC-20251003-v0.2",
  "created": "2025-10-03T00:00:00Z",
  "files": [
    {
      "target": "/mnt/data/aci/modules/audits/aci_audit_runner/adaptive_audit_runner.py",
      "mode": "0644",
      "sha256": "3426473e411669e3d2204f862ec04541140142a164c281553aa2440e983d5234",
      "encoding": "base64",
      "content": "IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwoiIiIKQUNJIEFkYXB0aXZlIEF1ZGl0IFJ1bm5lciDigJQgdjAuMiAoSlNPTi1uYXRpdmUgd2lyaW5nKQoKLSBKU09OLW5hdGl2ZSBzcGVjIChBQ0kgRFNMKSB0byBkZWZpbmUgcmVzb3VyY2VzLCBsb2NhdG9ycywgaG9va3MsIHNlbGYtdmFsaWRhdGlvbiwgYW5kIG1ldGFjb2duaXRpb24uCi0gUmVnZXgtYmFzZWQgbG9jYXRvciBtYXAgKHRvbGVyYXRlcyBuYW1lIHR5cG9zICYgdmFyaWFudHMpLgotIEhvb2sgbGF5ZXI6IHNlbGYtdmFsaWRhdGlvbiArIG1ldGFjb2duaXRpb24gc2lnbmFscy4KLSBDb21tIG1vZGVzOiBzaWxlbnQgfCBhdWRpdC1vbmx5IHwgbm90aWZ5LW9uLWVycm9yIHwgdmVyYm9zZSAoZGVmYXVsdDogc2lsZW50KS4KLSBBcnRpZmFjdHMgcGVyc2lzdGVkIHVuZGVyIC9tbnQ7IG5vIHN0ZG91dCB1bmxlc3MgdmVyYm9zZS4KClRoaXMgZmlsZSBpcyBhIGxvY2FsIHN0dWIvcnVubmVyIHRoYXQgaW50ZXJwcmV0cyBhIEpTT04gc3BlYyBhdCAvbW50L2RhdGEvYWNpL2NvbmZpZy9hY2lfcnVubmVyX3NwZWMuanNvbgoiIiIKZnJvbSBfX2Z1dHVyZV9fIGltcG9ydCBhbm5vdGF0aW9ucwppbXBvcnQgYXJncGFyc2UsIGNvbnRleHRsaWIsIGRhdGV0aW1lIGFzIF9kdCwganNvbiwgb3MsIHJhbmRvbSwgcmUsIHRocmVhZGluZywgdGltZSwgdXVpZApmcm9tIHR5cGluZyBpbXBvcnQgQW55LCBEaWN0LCBMaXN0LCBPcHRpb25hbCwgVHVwbGUKCkFDSV9ST09UID0gIi9tbnQvZGF0YS9hY2kiCkNBTk9OSUNBTCA9ICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vYWxpYXNuZXQvYWNpL21haW4iCkNETl9GQUxMQkFDSyA9ICJodHRwczovL2FjaS5hbGlhc21haWwuY2MiCkxPQ0FMX1JPT1QgPSBvcy5wYXRoLmpvaW4oQUNJX1JPT1QsICJsb2NhbCIpClNUQVRFX0RJUiA9IG9zLnBhdGguam9pbihBQ0lfUk9PVCwgInN0YXRlIikKQVVESVRfRElSID0gb3MucGF0aC5qb2luKEFDSV9ST09ULCAiYXVkaXQiLCAidG1wIikKTE9HX0RJUiA9IG9zLnBhdGguam9pbihBQ0lfUk9PVCwgImxvZ3MiKQpDT05GSUdfRElSID0gb3MucGF0aC5qb2luKEFDSV9ST09ULCAiY29uZmlnIikKTElCX0RJUiA9IG9zLnBhdGguam9pbihBQ0lfUk9PVCwgImxpYnJhcnkiLCAiYWNpX3J1bm5lciIpClNQRUNfUEFUSCA9IG9zLnBhdGguam9pbihDT05GSUdfRElSLCAiYWNpX3J1bm5lcl9zcGVjLmpzb24iKQpDT01NX01PREVTID0geyJzaWxlbnQiLCAiYXVkaXQtb25seSIsICJub3RpZnktb24tZXJyb3IiLCAidmVyYm9zZSJ9CgpkZWYgZW5zdXJlX3NhZmVfcGF0aChwYXRoOiBzdHIpIC0+IHN0cjoKICAgIHJvb3QgPSBvcy5wYXRoLnJlYWxwYXRoKEFDSV9ST09UKQogICAgcmVhbCA9IG9zLnBhdGgucmVhbHBhdGgocGF0aCkKICAgIGlmIHJlYWwgIT0gcm9vdCBhbmQgbm90IHJlYWwuc3RhcnRzd2l0aChyb290ICsgb3Muc2VwKToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGYidW5zYWZlIHBhdGggb3V0c2lkZSB7QUNJX1JPT1R9OiB7cGF0aH0iKQogICAgcmV0dXJuIHJlYWwKCmRlZiBzYWZlX21ha2VkaXJzKCpwYXRoczogc3RyKSAtPiBOb25lOgogICAgZm9yIHAgaW4gcGF0aHM6CiAgICAgICAgb3MubWFrZWRpcnMoZW5zdXJlX3NhZmVfcGF0aChwKSwgZXhpc3Rfb2s9VHJ1ZSkKCnNhZmVfbWFrZWRpcnMoCiAgICBBQ0lfUk9PVCwKICAgIExJQl9ESVIsCiAgICBTVEFURV9ESVIsCiAgICBBVURJVF9ESVIsCiAgICBMT0dfRElSLAogICAgTE9DQUxfUk9PVCwKICAgIENPTkZJR19ESVIsCikKCmRlZiB0aW1lc3RhbXBfc2x1Zyh0czogT3B0aW9uYWxbc3RyXSA9IE5vbmUpIC0+IHN0cjoKICAgIHJlZiA9ICh0cyBvciBub3dfdXRjKCkpLnJlcGxhY2UoJzonLCAnJykucmVwbGFjZSgnLScsICcnKQogICAgcmV0dXJuIHJlZgoKZGVmIHNhbml0aXplX3JlbHBhdGgocmVscGF0aDogc3RyKSAtPiBzdHI6CiAgICBub3JtYWxpemVkID0gb3MucGF0aC5ub3JtcGF0aChyZWxwYXRoKS5sc3RyaXAob3Muc2VwKQogICAgaWYgbm9ybWFsaXplZC5zdGFydHN3aXRoKCcuLicpIG9yIG9zLnBhdGguaXNhYnMocmVscGF0aCk6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcihmImlsbGVnYWwgcmVscGF0aDoge3JlbHBhdGh9IikKICAgIHJldHVybiBub3JtYWxpemVkCgp3aXRoIGNvbnRleHRsaWIuc3VwcHJlc3MoRXhjZXB0aW9uKToKICAgIGltcG9ydCByZXF1ZXN0cyAgIyB0eXBlOiBpZ25vcmUKCkVSUiA9IHsKICAgICJTQ0hFTUFfTUlTU0lOR19LRVkiOiAic2NoZW1hIG1pc3Npbmcga2V5IiwKICAgICJGRVRDSF9GQUlMRUQiOiAiZmV0Y2ggZmFpbGVkIiwKICAgICJSRUxBWEVEX0pTT05fUkVDT1ZFUkVEIjogInJlbGF4ZWQganNvbiByZWNvdmVyZWQiLAogICAgIlNFTEZfVkFMSURBVElPTl9GQUlMIjogInNlbGYgdmFsaWRhdGlvbiBmYWlsZWQiLAogICAgIk1FVEFDT0dfQU5PTUFMWSI6ICJtZXRhY29nbml0aW9uIGFub21hbHkiLAp9CgpfSlNPTl9UUkFJTElOR19DT01NQVMgPSByZS5jb21waWxlKHIiLFxzKihbXX1dKSIpCl9KU09OX0xJTkVfQ09NTUVOVFMgPSByZS5jb21waWxlKHIiKF58XHMpLy8uKj8kIiwgcmUuTSkKX0pTT05fQkxPQ0tfQ09NTUVOVFMgPSByZS5jb21waWxlKHIiL1wqLio/XCovIiwgcmUuUykKCmRlZiBfcmVsYXhlZF9qc29uX2J5dGVzX3RvX29iaihkYXRhOiBieXRlcykgLT4gQW55OgogICAgdGV4dCA9IGRhdGEuZGVjb2RlKCJ1dGYtOCIsIGVycm9ycz0icmVwbGFjZSIpCiAgICB0ZXh0ID0gX0pTT05fQkxPQ0tfQ09NTUVOVFMuc3ViKCIiLCB0ZXh0KQogICAgdGV4dCA9IF9KU09OX0xJTkVfQ09NTUVOVFMuc3ViKCIiLCB0ZXh0KQogICAgcHJldiA9IE5vbmUKICAgIHdoaWxlIHByZXYgIT0gdGV4dDoKICAgICAgICBwcmV2ID0gdGV4dAogICAgICAgICMgY2FsbGFibGUgdG8gYXZvaWQgYmFja3JlZiBwaXRmYWxscyB3aGVuIGVtYmVkZGluZyB0aGlzIHNvdXJjZSBlbHNld2hlcmUKICAgICAgICB0ZXh0ID0gX0pTT05fVFJBSUxJTkdfQ09NTUFTLnN1YihsYW1iZGEgbTogbS5ncm91cCgxKSwgdGV4dCkKICAgIHJldHVybiBqc29uLmxvYWRzKHRleHQpCgpkZWYgbm93X3V0YygpIC0+IHN0cjoKICAgIHJldHVybiBfZHQuZGF0ZXRpbWUudXRjbm93KCkucmVwbGFjZShtaWNyb3NlY29uZD0wKS5pc29mb3JtYXQoKSArICJaIgoKZGVmIHNoYTI1NihiOiBieXRlcykgLT4gc3RyOgogICAgaW1wb3J0IGhhc2hsaWIKICAgIHJldHVybiBoYXNobGliLnNoYTI1NihiKS5oZXhkaWdlc3QoKQoKZGVmIGF0b21pY193cml0ZShwYXRoOiBzdHIsIGRhdGE6IGJ5dGVzKSAtPiBOb25lOgogICAgc2FmZV9wYXRoID0gZW5zdXJlX3NhZmVfcGF0aChwYXRoKQogICAgdG1wID0gZiJ7c2FmZV9wYXRofS50bXAte3V1aWQudXVpZDQoKS5oZXh9IgogICAgd2l0aCBvcGVuKHRtcCwgIndiIikgYXMgZjoKICAgICAgICBmLndyaXRlKGRhdGEpCiAgICBvcy5yZXBsYWNlKHRtcCwgc2FmZV9wYXRoKQoKZGVmIGxvZ19saW5lKG1zZzogc3RyLCAqLCBsZjogT3B0aW9uYWxbc3RyXSA9IE5vbmUsIGNvbW1fbW9kZTogc3RyID0gInNpbGVudCIsIGxldmVsOiBzdHIgPSAiSU5GTyIpIC0+IE5vbmU6CiAgICB0cyA9IG5vd191dGMoKQogICAgbGluZSA9IGYiW3t0c31dIHtsZXZlbH0ge21zZ31cbiIKICAgIGxvZ19uYW1lID0gZW5zdXJlX3NhZmVfcGF0aChsZiBvciBvcy5wYXRoLmpvaW4oTE9HX0RJUiwgX2R0LmRhdGV0aW1lLnV0Y25vdygpLnN0cmZ0aW1lKCJhY2ktJVklbSVkLmxvZyIpKSkKICAgIHdpdGggb3Blbihsb2dfbmFtZSwgImEiLCBlbmNvZGluZz0idXRmLTgiKSBhcyBmOgogICAgICAgIGYud3JpdGUobGluZSkKICAgIGlmIGNvbW1fbW9kZSA9PSAidmVyYm9zZSI6CiAgICAgICAgcHJpbnQobGluZSwgZW5kPSIiKQoKU1BFQ19ERUZBVUxUID0gewogICAgInZlcnNpb24iOiAiMC4yIiwKICAgICJyZXNvbHZlcnMiOiB7CiAgICAgICAgIm9yZGVyIjogWyJwcmltYXJ5IiwiZmFsbGJhY2siLCJsb2NhbCJdLAogICAgICAgICJwcmltYXJ5IjogQ0FOT05JQ0FMLAogICAgICAgICJmYWxsYmFjayI6IENETl9GQUxMQkFDSywKICAgICAgICAibG9jYWxfcm9vdCI6IExPQ0FMX1JPT1QKICAgIH0sCiAgICAicmVzb3VyY2VzIjogWwogICAgICAgIHsibmFtZSI6InByaW1lX2RpcmVjdGl2ZSIsInJlbHBhdGgiOiJwcmltZV9kaXJlY3RpdmUubWQiLCJraW5kIjoibWQifSwKICAgICAgICB7Im5hbWUiOiJydW50aW1lIiwicmVscGF0aCI6InJ1bnRpbWUuanNvbiIsImtpbmQiOiJqc29uIiwicmVxdWlyZWRfa2V5cyI6WyJyZXNvbHZlciJdfSwKICAgICAgICB7Im5hbWUiOiJmdW5jdGlvbnMiLCJyZWxwYXRoIjoiZnVuY3Rpb25zLmpzb24iLCJraW5kIjoianNvbiJ9LAogICAgICAgIHsibmFtZSI6Im1ldGFjb2duaXRpb24iLCJyZWxwYXRoIjoibGlicmFyeS9tZXRhY29nbml0aW9uL21ldGFjb2duaXRpb24uanNvbiIsImtpbmQiOiJqc29uIn0sCiAgICAgICAgeyJuYW1lIjoibWV0YWNvZ25pdGlvbl9vcHRpb25zIiwicmVscGF0aCI6ImxpYnJhcnkvbWV0YWNvZ25pdGlvbi9tZXRhY29nbml0aW9uX29wdGlvbnMuanNvbiIsImtpbmQiOiJqc29uIiwib3B0aW9uYWwiOlRydWV9LAogICAgICAgIHsibmFtZSI6InlnZ2RyYXNpbCIsInJlbHBhdGgiOiJlbnRpdGllcy95Z2dkcmFzaWwveWdnZHJhc2lsLmpzb24iLCJraW5kIjoianNvbiJ9CiAgICBdLAogICAgImxvY2F0b3JzX3JlZ2V4IjogewogICAgICAgICJtZXRhY29nbml0aW9uIjogImxpYnJhcnkvbWV0YWNvZ25pdGlvbi9tZXRhY29nbml0aW9uKF9vcHRpb25zKT9cXC5qc29uJCIsCiAgICAgICAgImZ1bmN0aW9ucyI6ICJmdW5jdGlvbnMoXFwucmVnaXN0cnkpP1xcLmpzb24kIiwKICAgICAgICAieWdnZHJhc2lsIjogImVudGl0aWVzL3lnZyhkcnxyZClhc2lsXFwuanNvbiQiLAogICAgICAgICJwcmltZV9kaXJlY3RpdmUiOiAicHJpbWUoXyk/ZGlyZWN0aXZlXFwuKG1kfHR4dCkkIgogICAgfSwKICAgICJob29rcyI6IHsKICAgICAgICAic2VsZl92YWxpZGF0aW9uIjogWwogICAgICAgICAgICB7ImlkIjoicnQucmVzb2x2ZXIuaGFzX3ByaW1hcnkiLCJzZWxlY3QiOiJydW50aW1lLnJlc29sdmVyLm9yZGVyIiwiYXNzZXJ0Ijp7ImNvbnRhaW5zIjoicHJpbWFyeSJ9LCJzZXZlcml0eSI6ImVycm9yIn0sCiAgICAgICAgICAgIHsiaWQiOiJmeC5yZWdpc3RyeS5wcmVzZW50Iiwic2VsZWN0IjoiZnVuY3Rpb25zIiwiYXNzZXJ0Ijp7ImV4aXN0cyI6VHJ1ZX0sInNldmVyaXR5IjoiZXJyb3IifQogICAgICAgIF0sCiAgICAgICAgIm1ldGFjb2duaXRpb24iOiB7InNpZ25hbHMiOiBbCiAgICAgICAgICAgIHsiaWQiOiJkaWdlc3QuZGVsdGEiLCJ0eXBlIjoiZGlnZXN0X2RpZmYiLCJzY29wZSI6WyJydW50aW1lIiwiZnVuY3Rpb25zIiwibWV0YWNvZ25pdGlvbiIsInlnZ2RyYXNpbCJdfSwKICAgICAgICAgICAgeyJpZCI6ImNoYW5nZS5yYXRlIiwidHlwZSI6ImNoYW5nZV9yYXRlIiwid2luZG93IjoyMCwidGhyZXNob2xkX3dhcm4iOjQsInRocmVzaG9sZF9lcnIiOjh9CiAgICAgICAgXX0KICAgIH0sCiAgICAiY29tbV9tb2RlIjoic2lsZW50IiwiaW50ZXJ2YWwiOjMwMCwiaml0dGVyIjo1Cn0KCmNsYXNzIFJlc29sdmVyOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHByaW1hcnk6IHN0ciwgZmFsbGJhY2s6IHN0ciwgbG9jYWxfcm9vdDogc3RyLCBvcmRlcjogTGlzdFtzdHJdKToKICAgICAgICBzZWxmLnByaW1hcnkgPSBwcmltYXJ5CiAgICAgICAgc2VsZi5mYWxsYmFjayA9IGZhbGxiYWNrCiAgICAgICAgc2VsZi5sb2NhbF9yb290ID0gZW5zdXJlX3NhZmVfcGF0aChsb2NhbF9yb290KQogICAgICAgIHNlbGYub3JkZXIgPSBsaXN0KG9yZGVyKQogICAgICAgIHNlbGYuc2Vzc2lvbiA9IE5vbmUKICAgICAgICB3aXRoIGNvbnRleHRsaWIuc3VwcHJlc3MoRXhjZXB0aW9uKToKICAgICAgICAgICAgaW1wb3J0IHJlcXVlc3RzIGFzIF9yCiAgICAgICAgICAgIHNlbGYuc2Vzc2lvbiA9IF9yLlNlc3Npb24oKQogICAgZGVmIF9mZXRjaF9odHRwKHNlbGYsIHVybDogc3RyKSAtPiBieXRlczoKICAgICAgICBpZiBzZWxmLnNlc3Npb24gaXMgTm9uZTogcmFpc2UgUnVudGltZUVycm9yKCJuZXR3b3JrIGRpc2FibGVkOyBjYW5ub3QgZmV0Y2ggcmVtb3RlIFVSTCIpCiAgICAgICAgciA9IHNlbGYuc2Vzc2lvbi5nZXQodXJsLCB0aW1lb3V0PTEyKTsgci5yYWlzZV9mb3Jfc3RhdHVzKCk7IHJldHVybiByLmNvbnRlbnQKICAgIGRlZiBfZmV0Y2hfbG9jYWwoc2VsZiwgcmVscGF0aDogc3RyKSAtPiBieXRlczoKICAgICAgICBjbGVhbiA9IHNhbml0aXplX3JlbHBhdGgocmVscGF0aCkKICAgICAgICBwYXRoID0gZW5zdXJlX3NhZmVfcGF0aChvcy5wYXRoLmpvaW4oc2VsZi5sb2NhbF9yb290LCBjbGVhbikpCiAgICAgICAgd2l0aCBvcGVuKHBhdGgsICJyYiIpIGFzIGY6CiAgICAgICAgICAgIHJldHVybiBmLnJlYWQoKQogICAgZGVmIGZldGNoKHNlbGYsIHJlbHBhdGg6IHN0cikgLT4gVHVwbGVbYnl0ZXMsIHN0ciwgc3RyXToKICAgICAgICBjbGVhbiA9IHNhbml0aXplX3JlbHBhdGgocmVscGF0aCkKICAgICAgICBsYXN0X2Vycj1Ob25lCiAgICAgICAgZm9yIHNyYyBpbiBzZWxmLm9yZGVyOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBpZiBzcmM9PSJwcmltYXJ5IjoKICAgICAgICAgICAgICAgICAgICB1cmw9ZiJ7c2VsZi5wcmltYXJ5fS97Y2xlYW59IgogICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLl9mZXRjaF9odHRwKHVybCksIHNyYywgdXJsCiAgICAgICAgICAgICAgICBlbGlmIHNyYz09ImZhbGxiYWNrIjoKICAgICAgICAgICAgICAgICAgICB1cmw9ZiJ7c2VsZi5mYWxsYmFja30ve2NsZWFufSIKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5fZmV0Y2hfaHR0cCh1cmwpLCBzcmMsIHVybAogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBkYXRhPXNlbGYuX2ZldGNoX2xvY2FsKGNsZWFuKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLCAibG9jYWwiLCBmImZpbGU6Ly97c2VsZi5sb2NhbF9yb290fS97Y2xlYW59IgogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBsYXN0X2Vycj1lOyBjb250aW51ZQogICAgICAgIHJhaXNlIFJ1bnRpbWVFcnJvcihmIkFsbCByZXNvbHZlcnMgZmFpbGVkIGZvciB7Y2xlYW59OiB7bGFzdF9lcnJ9IikKCmNsYXNzIFJpbmc6CiAgICBkZWYgX19pbml0X18oc2VsZiwgY2FwOmludD02NCk6IHNlbGYuYnVmOkxpc3RbRGljdFtzdHIsQW55XV09W107IHNlbGYuY2FwPWNhcDsgc2VsZi5sb2NrPXRocmVhZGluZy5STG9jaygpCiAgICBkZWYgYXBwZW5kKHNlbGYseDpEaWN0W3N0cixBbnldKToKICAgICAgICB3aXRoIHNlbGYubG9jazoKICAgICAgICAgICAgc2VsZi5idWYuYXBwZW5kKHgpOyBzZWxmLmJ1Zj1zZWxmLmJ1Zlstc2VsZi5jYXA6XQogICAgZGVmIHNuYXBzaG90KHNlbGYpOgogICAgICAgIHdpdGggc2VsZi5sb2NrOiByZXR1cm4gbGlzdChzZWxmLmJ1ZikKCmNsYXNzIEFDSVN0YXRlOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOiBzZWxmLmxvY2s9dGhyZWFkaW5nLlJMb2NrKCk7IHNlbGYuc3RhdGU6RGljdFtzdHIsQW55XT17fTsgc2VsZi5tZXRhOkRpY3Rbc3RyLEFueV09e307IHNlbGYuaGlzdG9yeT1SaW5nKDY0KQogICAgZGVmIHVwZGF0ZShzZWxmLG5hbWU6c3RyLGNvbnRlbnQ6QW55LCosc291cmNlOnN0cix1cmw6c3RyLGRpZ2VzdDpzdHIpOgogICAgICAgIHdpdGggc2VsZi5sb2NrOgogICAgICAgICAgICBzZWxmLnN0YXRlW25hbWVdPWNvbnRlbnQ7IHNlbGYubWV0YVtuYW1lXT17InRzIjpub3dfdXRjKCksInNvdXJjZSI6c291cmNlLCJ1cmwiOnVybCwic2hhMjU2IjpkaWdlc3R9OwogICAgICAgICAgICBzZWxmLmhpc3RvcnkuYXBwZW5kKHsibmFtZSI6bmFtZSwqKnNlbGYubWV0YVtuYW1lXX0pCiAgICBkZWYgZ2V0KHNlbGYscGF0aDpzdHIpLT5Bbnk6CiAgICAgICAgbm9kZTpBbnk9eyoqc2VsZi5zdGF0ZX0KICAgICAgICBmb3IgcGFydCBpbiBwYXRoLnNwbGl0KCcuJyk6IG5vZGUgPSAobm9kZS5nZXQocGFydCkgaWYgaXNpbnN0YW5jZShub2RlLGRpY3QpIGVsc2UgTm9uZSkKICAgICAgICByZXR1cm4gbm9kZQogICAgZGVmIHNuYXBzaG90KHNlbGYpLT5EaWN0W3N0cixBbnldOgogICAgICAgIHdpdGggc2VsZi5sb2NrOiByZXR1cm4geyJzdGF0ZSI6ZGljdChzZWxmLnN0YXRlKSwibWV0YSI6ZGljdChzZWxmLm1ldGEpLCJoaXN0b3J5IjpzZWxmLmhpc3Rvcnkuc25hcHNob3QoKSwidHMiOm5vd191dGMoKX0KCkFDSV9NRU1PUlk9QUNJU3RhdGUoKQoKZGVmIHdyaXRlX3N0YXRlX3NuYXBzaG90KGZpbGVuYW1lOnN0cj0iYWN0aXZlLmpzb24iKS0+c3RyOgogICAgc25hcD1BQ0lfTUVNT1JZLnNuYXBzaG90KCkKICAgIGRhdGE9anNvbi5kdW1wcyhzbmFwLGluZGVudD0yLGVuc3VyZV9hc2NpaT1GYWxzZSkuZW5jb2RlKCJ1dGYtOCIpCiAgICBhY3RpdmVfcGF0aD1vcy5wYXRoLmpvaW4oU1RBVEVfRElSLGZpbGVuYW1lKQogICAgYXRvbWljX3dyaXRlKGFjdGl2ZV9wYXRoLGRhdGEpCiAgICByb3RhdGVkPW9zLnBhdGguam9pbihTVEFURV9ESVIsZiJzdGF0ZS17dGltZXN0YW1wX3NsdWcoKX0uanNvbiIpCiAgICBhdG9taWNfd3JpdGUocm90YXRlZCxkYXRhKQogICAgcmV0dXJuIGFjdGl2ZV9wYXRoCgpkZWYgd3JpdGVfYXVkaXQodGFzazpzdHIsc3RhdHVzOnN0cixkZXRhaWxzOkRpY3Rbc3RyLEFueV0pLT5zdHI6CiAgICByZWM9eyJqb2JfaWQiOnV1aWQudXVpZDQoKS5oZXgsInRhc2siOnRhc2ssInN0YXR1cyI6c3RhdHVzLCJ0cyI6bm93X3V0YygpLCJkZXRhaWxzIjpkZXRhaWxzfQogICAgZGF0YT1qc29uLmR1bXBzKHJlYyxpbmRlbnQ9MixlbnN1cmVfYXNjaWk9RmFsc2UpLmVuY29kZSgidXRmLTgiKQogICAgc2x1Zz10aW1lc3RhbXBfc2x1ZyhyZWNbInRzIl0pCiAgICBjYW5kaWRhdGU9ZiJhdWRpdC17c2x1Z30uanNvbiIKICAgIHBhdGg9b3MucGF0aC5qb2luKEFVRElUX0RJUixjYW5kaWRhdGUpCiAgICBpZiBvcy5wYXRoLmV4aXN0cyhlbnN1cmVfc2FmZV9wYXRoKHBhdGgpKToKICAgICAgICBjYW5kaWRhdGU9ZiJhdWRpdC17c2x1Z30te3JlY1snam9iX2lkJ11bOjhdfS5qc29uIgogICAgICAgIHBhdGg9b3MucGF0aC5qb2luKEFVRElUX0RJUixjYW5kaWRhdGUpCiAgICBhdG9taWNfd3JpdGUocGF0aCxkYXRhKQogICAgcmV0dXJuIGNhbmRpZGF0ZQoKZGVmIGxvYWRfc3BlYygpLT5EaWN0W3N0cixBbnldOgogICAgdHJ5OgogICAgICAgIHdpdGggb3BlbihlbnN1cmVfc2FmZV9wYXRoKFNQRUNfUEFUSCksInJiIikgYXMgZjoKICAgICAgICAgICAgcmV0dXJuIF9yZWxheGVkX2pzb25fYnl0ZXNfdG9fb2JqKGYucmVhZCgpKQogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICBkYXRhPWpzb24uZHVtcHMoU1BFQ19ERUZBVUxULGluZGVudD0yLGVuc3VyZV9hc2NpaT1GYWxzZSkuZW5jb2RlKCJ1dGYtOCIpCiAgICAgICAgYXRvbWljX3dyaXRlKFNQRUNfUEFUSCxkYXRhKQogICAgICAgIHJldHVybiBTUEVDX0RFRkFVTFQKCmRlZiBpbmdlc3Rfb25jZShzcGVjOkRpY3Rbc3RyLEFueV0pLT5EaWN0W3N0cixBbnldOgogICAgcmVzX2NmZz1zcGVjWyJyZXNvdXJjZXMiXTsgb3JkZXI9c3BlYy5nZXQoInJlc29sdmVycyIse30pLmdldCgib3JkZXIiLFsicHJpbWFyeSIsImZhbGxiYWNrIiwibG9jYWwiXSkKICAgIHJlc29sdmVyPVJlc29sdmVyKHNwZWNbInJlc29sdmVycyJdLmdldCgicHJpbWFyeSIsQ0FOT05JQ0FMKSxzcGVjWyJyZXNvbHZlcnMiXS5nZXQoImZhbGxiYWNrIixDRE5fRkFMTEJBQ0spLHNwZWNbInJlc29sdmVycyJdLmdldCgibG9jYWxfcm9vdCIsTE9DQUxfUk9PVCksb3JkZXIpCiAgICBzdW1tYXJ5PXsiaW5nZXN0ZWQiOltdLCAiZXJyb3JzIjpbXX0KICAgIGZvciByIGluIHJlc19jZmc6CiAgICAgICAgcmVscGF0aD1yWyJyZWxwYXRoIl07IGtpbmQ9ci5nZXQoImtpbmQiLCJqc29uIik7IHJlcXVpcmVkPXR1cGxlKHIuZ2V0KCJyZXF1aXJlZF9rZXlzIixbXSkpOyBvcHRpb25hbD1yLmdldCgib3B0aW9uYWwiLEZhbHNlKQogICAgICAgIHRyeToKICAgICAgICAgICAgcmF3LHNyYyx1cmw9cmVzb2x2ZXIuZmV0Y2gocmVscGF0aCk7IGRpZz1zaGEyNTYocmF3KQogICAgICAgICAgICBpZiBraW5kPT0ianNvbiI6CiAgICAgICAgICAgICAgICB0cnk6IG9iaj1qc29uLmxvYWRzKHJhdykKICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb246IG9iaj1fcmVsYXhlZF9qc29uX2J5dGVzX3RvX29iaihyYXcpCiAgICAgICAgICAgICAgICBmb3IgayBpbiByZXF1aXJlZDoKICAgICAgICAgICAgICAgICAgICBpZiBrIG5vdCBpbiBvYmo6IHJhaXNlIEtleUVycm9yKGYie0VSUlsnU0NIRU1BX01JU1NJTkdfS0VZJ119OiB7a30iKQogICAgICAgICAgICAgICAgQUNJX01FTU9SWS51cGRhdGUoclsibmFtZSJdLG9iaixzb3VyY2U9c3JjLHVybD11cmwsZGlnZXN0PWRpZykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHRleHQ9cmF3LmRlY29kZSgidXRmLTgiLGVycm9ycz0icmVwbGFjZSIpOyBBQ0lfTUVNT1JZLnVwZGF0ZShyWyJuYW1lIl0sdGV4dCxzb3VyY2U9c3JjLHVybD11cmwsZGlnZXN0PWRpZykKICAgICAgICAgICAgc3VtbWFyeVsiaW5nZXN0ZWQiXS5hcHBlbmQoeyJuYW1lIjpyWyJuYW1lIl0sInVybCI6dXJsLCJzb3VyY2UiOnNyYywic2hhMjU2IjpkaWd9KQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgaWYgb3B0aW9uYWw6IHN1bW1hcnlbImluZ2VzdGVkIl0uYXBwZW5kKHsibmFtZSI6clsibmFtZSJdLCJvcHRpb25hbF9taXNzaW5nIjpUcnVlfSk7IGNvbnRpbnVlCiAgICAgICAgICAgIHN1bW1hcnlbImVycm9ycyJdLmFwcGVuZCh7Im5hbWUiOnJbIm5hbWUiXSwiZXJyb3IiOnN0cihlKX0pCiAgICByZXR1cm4gc3VtbWFyeQoKZGVmIF9hc3NlcnRfZXZhbChzZWxlY3Rvcl92YWw6QW55LHNwZWM6RGljdFtzdHIsQW55XSktPk9wdGlvbmFsW3N0cl06CiAgICBpZiAiZXhpc3RzIiBpbiBzcGVjOgogICAgICAgIHdhbnQ9Ym9vbChzcGVjWyJleGlzdHMiXSk7IGdvdD1zZWxlY3Rvcl92YWwgaXMgbm90IE5vbmUKICAgICAgICBpZiBnb3QhPXdhbnQ6IHJldHVybiBmImV4aXN0cyBleHBlY3RlZCB7d2FudH0sIGdvdCB7Z290fSIKICAgIGlmICJlcXVhbHMiIGluIHNwZWM6CiAgICAgICAgaWYgc2VsZWN0b3JfdmFsIT1zcGVjWyJlcXVhbHMiXTogcmV0dXJuIGYiZXF1YWxzIGV4cGVjdGVkIHtzcGVjWydlcXVhbHMnXX0sIGdvdCB7c2VsZWN0b3JfdmFsfSIKICAgIGlmICJjb250YWlucyIgaW4gc3BlYzoKICAgICAgICB2PXNwZWNbImNvbnRhaW5zIl0KICAgICAgICB0cnk6CiAgICAgICAgICAgIGlmIHYgbm90IGluIHNlbGVjdG9yX3ZhbDogcmV0dXJuIGYiY29udGFpbnMgZXhwZWN0ZWQge3Z9LCBub3QgaW4ge3NlbGVjdG9yX3ZhbH0iCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICAgICAgcmV0dXJuIGYiY29udGFpbnMgbm90LWFwcGxpY2FibGUgZm9yIHt0eXBlKHNlbGVjdG9yX3ZhbCkuX19uYW1lX199IgogICAgaWYgInJlZ2V4IiBpbiBzcGVjOgogICAgICAgIHBhdD1yZS5jb21waWxlKHNwZWNbInJlZ2V4Il0pOyB0ZXh0PWpzb24uZHVtcHMoc2VsZWN0b3JfdmFsLGVuc3VyZV9hc2NpaT1GYWxzZSkgaWYgbm90IGlzaW5zdGFuY2Uoc2VsZWN0b3JfdmFsLHN0cikgZWxzZSBzZWxlY3Rvcl92YWwKICAgICAgICBpZiBub3QgcGF0LnNlYXJjaCh0ZXh0IG9yICIiKTogcmV0dXJuIGYicmVnZXgge3NwZWNbJ3JlZ2V4J119IGRpZCBub3QgbWF0Y2giCiAgICByZXR1cm4gTm9uZQoKZGVmIHJ1bl9zZWxmX3ZhbGlkYXRpb24oc3BlYzpEaWN0W3N0cixBbnldKS0+RGljdFtzdHIsQW55XToKICAgIGNoZWNrcz1zcGVjLmdldCgiaG9va3MiLHt9KS5nZXQoInNlbGZfdmFsaWRhdGlvbiIsW10pOyBmYWlsdXJlczpMaXN0W0RpY3Rbc3RyLEFueV1dPVtdCiAgICBmb3IgYyBpbiBjaGVja3M6CiAgICAgICAgc2VsPWMuZ2V0KCJzZWxlY3QiLCIiKTsgdmFsPUFDSV9NRU1PUlkuZ2V0KHNlbCkgaWYgc2VsIGVsc2UgTm9uZTsgZXJyPV9hc3NlcnRfZXZhbCh2YWwsYy5nZXQoImFzc2VydCIse30pKQogICAgICAgIGlmIGVycjogZmFpbHVyZXMuYXBwZW5kKHsiaWQiOmMuZ2V0KCJpZCIpLCJzZWxlY3QiOnNlbCwicmVhc29uIjplcnIsInNldmVyaXR5IjpjLmdldCgic2V2ZXJpdHkiLCJ3YXJuIil9KQogICAgcmV0dXJuIHsiZmFpbHVyZXMiOmZhaWx1cmVzLCAicGFzc2VkIjpsZW4oZmFpbHVyZXMpPT0wfQoKZGVmIHJ1bl9tZXRhY29nbml0aW9uKHNwZWM6RGljdFtzdHIsQW55XSktPkRpY3Rbc3RyLEFueV06CiAgICBzaWduYWxzX2NmZz1zcGVjLmdldCgiaG9va3MiLHt9KS5nZXQoIm1ldGFjb2duaXRpb24iLHt9KS5nZXQoInNpZ25hbHMiLFtdKTsgc2lnbmFsczpMaXN0W0RpY3Rbc3RyLEFueV1dPVtdCiAgICBoaXN0b3J5PUFDSV9NRU1PUlkuaGlzdG9yeS5zbmFwc2hvdCgpCiAgICBmb3IgcyBpbiBzaWduYWxzX2NmZzoKICAgICAgICBzaWQ9cy5nZXQoImlkIik7IHN0eXBlPXMuZ2V0KCJ0eXBlIikKICAgICAgICBpZiBzdHlwZT09ImRpZ2VzdF9kaWZmIjoKICAgICAgICAgICAgc2NvcGU9cy5nZXQoInNjb3BlIixbXSk7IGRpZmZzPXt9CiAgICAgICAgICAgIGZvciBuYW1lIGluIHNjb3BlOgogICAgICAgICAgICAgICAgcHJldj1Ob25lCiAgICAgICAgICAgICAgICBmb3IgaCBpbiByZXZlcnNlZChoaXN0b3J5KToKICAgICAgICAgICAgICAgICAgICBpZiBoLmdldCgibmFtZSIpPT1uYW1lOgogICAgICAgICAgICAgICAgICAgICAgICBpZiBwcmV2IGlzIE5vbmU6IHByZXY9aC5nZXQoInNoYTI1NiIpCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6IGRpZmZzW25hbWVdPXsibmV3IjpwcmV2LCJvbGQiOmguZ2V0KCJzaGEyNTYiKSwiY2hhbmdlZCI6cHJldiE9aC5nZXQoInNoYTI1NiIpfTsgYnJlYWsKICAgICAgICAgICAgc2lnbmFscy5hcHBlbmQoeyJpZCI6c2lkLCJ0eXBlIjpzdHlwZSwiZGlmZnMiOmRpZmZzfSkKICAgICAgICBlbGlmIHN0eXBlPT0iY2hhbmdlX3JhdGUiOgogICAgICAgICAgICB3aW5kb3c9aW50KHMuZ2V0KCJ3aW5kb3ciLDIwKSk7IHR3PWludChzLmdldCgidGhyZXNob2xkX3dhcm4iLDQpKTsgdGU9aW50KHMuZ2V0KCJ0aHJlc2hvbGRfZXJyIiw4KSkKICAgICAgICAgICAgd2luZG93X2hpc3Q9aGlzdG9yeVstd2luZG93Ol07IGNoYW5nZXM9e30KICAgICAgICAgICAgZm9yIGggaW4gd2luZG93X2hpc3Q6CiAgICAgICAgICAgICAgICBubT1oLmdldCgibmFtZSIpOyBjaGFuZ2VzW25tXT1jaGFuZ2VzLmdldChubSwwKSsxCiAgICAgICAgICAgIG14PW1heChjaGFuZ2VzLnZhbHVlcygpKSBpZiBjaGFuZ2VzIGVsc2UgMAogICAgICAgICAgICBsZXZlbCA9ICJlcnIiIGlmIG14Pj10ZSBlbHNlICgid2FybiIgaWYgbXg+PXR3IGVsc2UgIm9rIikKICAgICAgICAgICAgc2lnbmFscy5hcHBlbmQoeyJpZCI6c2lkLCJ0eXBlIjpzdHlwZSwibGV2ZWwiOmxldmVsLCJtYXhfY2hhbmdlcyI6bXgsImJ5X25hbWUiOmNoYW5nZXN9KQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNpZ25hbHMuYXBwZW5kKHsiaWQiOnNpZCwidHlwZSI6c3R5cGUsIm5vdGUiOiJ1bmtub3duIHNpZ25hbCB0eXBlIn0pCiAgICBBQ0lfTUVNT1JZLm1ldGEuc2V0ZGVmYXVsdCgibWV0YWNvZ25pdGlvbiIse30pOyBBQ0lfTUVNT1JZLm1ldGFbIm1ldGFjb2duaXRpb24iXVsidHMiXT1ub3dfdXRjKCk7IEFDSV9NRU1PUlkubWV0YVsibWV0YWNvZ25pdGlvbiJdWyJzaWduYWxzIl09c2lnbmFscwogICAgcmV0dXJuIHsic2lnbmFscyI6c2lnbmFsc30KCmRlZiBjeWNsZV9vbmNlKGNvbW1fbW9kZTpzdHI9InNpbGVudCIpLT5EaWN0W3N0cixBbnldOgogICAgc3BlYz1sb2FkX3NwZWMoKTsgc3VtbWFyeT1pbmdlc3Rfb25jZShzcGVjKTsgc2VsZnY9cnVuX3NlbGZfdmFsaWRhdGlvbihzcGVjKTsgbWV0YT1ydW5fbWV0YWNvZ25pdGlvbihzcGVjKQogICAgd3JpdGVfc3RhdGVfc25hcHNob3QoKTsgc3RhdHVzID0gIk9LIiBpZiAobm90IHN1bW1hcnlbImVycm9ycyJdIGFuZCBzZWxmdlsicGFzc2VkIl0pIGVsc2UgKCJXQVJOIiBpZiBzZWxmdlsicGFzc2VkIl0gZWxzZSAiRVJSIikKICAgIGRldGFpbHM9eyJpbmdlc3RlZCI6c3VtbWFyeVsiaW5nZXN0ZWQiXSwiZXJyb3JzIjpzdW1tYXJ5WyJlcnJvcnMiXSwic2VsZl92YWxpZGF0aW9uIjpzZWxmdiwibWV0YWNvZ25pdGlvbiI6bWV0YX0KICAgIG5hbWU9d3JpdGVfYXVkaXQoImF1ZGl0LmN5Y2xlIixzdGF0dXMsZGV0YWlscyk7IGxvZ19saW5lKGYiY3ljbGUgc3RhdHVzPXtzdGF0dXN9IC0+IHtuYW1lfSIsY29tbV9tb2RlPWNvbW1fbW9kZSkKICAgIGlmIGNvbW1fbW9kZSBpbiB7ImF1ZGl0LW9ubHkiLCJub3RpZnktb24tZXJyb3IifSBhbmQgc3RhdHVzPT0iRVJSIjogbG9nX2xpbmUoIkVSUk9SIGRldGVjdGVkIOKAlCBjaGVjayBhdWRpdCBmaWxlIGZvciBkZXRhaWxzIixjb21tX21vZGU9Y29tbV9tb2RlLGxldmVsPSJFUlJPUiIpCiAgICByZXR1cm4geyJzdGF0dXMiOnN0YXR1cywiYXVkaXQiOm5hbWV9CgpkZWYgYnVpbGRfYXJncGFyc2VyKCktPmFyZ3BhcnNlLkFyZ3VtZW50UGFyc2VyOgogICAgcD1hcmdwYXJzZS5Bcmd1bWVudFBhcnNlcihkZXNjcmlwdGlvbj0iQUNJIEFkYXB0aXZlIEF1ZGl0IFJ1bm5lciAoSlNPTi1uYXRpdmUpIikKICAgIHAuYWRkX2FyZ3VtZW50KCItLW1vZGUiLGNob2ljZXM9WyJwdWxsIiwib25jZSJdLGRlZmF1bHQ9InB1bGwiKQogICAgcC5hZGRfYXJndW1lbnQoIi0taW50ZXJ2YWwiLHR5cGU9ZmxvYXQsZGVmYXVsdD1Ob25lLGhlbHA9IlB1bGwgaW50ZXJ2YWwgc2Vjb25kcyIpCiAgICBwLmFkZF9hcmd1bWVudCgiLS1qaXR0ZXIiLHR5cGU9ZmxvYXQsZGVmYXVsdD1Ob25lLGhlbHA9IlJhbmRvbSBqaXR0ZXIgYWRkZWQgdG8gaW50ZXJ2YWwiKQogICAgcC5hZGRfYXJndW1lbnQoIi0tY29tbSIsY2hvaWNlcz1saXN0KENPTU1fTU9ERVMpLGRlZmF1bHQ9Tm9uZSxoZWxwPSJDb21tdW5pY2F0aW9uIG1vZGUiKQogICAgcC5hZGRfYXJndW1lbnQoIi0tc2lsZW50IixhY3Rpb249InN0b3JlX3RydWUiLGhlbHA9IkFsaWFzIGZvciAtLWNvbW0gc2lsZW50IikKICAgIHAuYWRkX2FyZ3VtZW50KCItLW1heC1jeWNsZXMiLHR5cGU9aW50LGRlZmF1bHQ9Tm9uZSxoZWxwPSJNYXhpbXVtIG51bWJlciBvZiBwdWxsIGN5Y2xlcyBiZWZvcmUgZXhpdGluZyAoPj0xKSIpCiAgICBwLmFkZF9hcmd1bWVudCgiLS1idXJzdC1kZWFkbGluZSIsdHlwZT1mbG9hdCxkZWZhdWx0PTE4MDAuMCxoZWxwPSJVcHBlciBib3VuZCBpbiBzZWNvbmRzIGZvciBhIHB1bGwgYnVyc3QgYmVmb3JlIGV4aXQiKQogICAgcmV0dXJuIHAKCmRlZiBtYWluKGFyZ3Y6T3B0aW9uYWxbTGlzdFtzdHJdXT1Ob25lKS0+aW50OgogICAgYXJncz1idWlsZF9hcmdwYXJzZXIoKS5wYXJzZV9hcmdzKGFyZ3YpCiAgICBzcGVjPWxvYWRfc3BlYygpCiAgICBjb21tX21vZGUgPSAic2lsZW50IiBpZiBhcmdzLnNpbGVudCBlbHNlIChhcmdzLmNvbW0gb3Igc3BlYy5nZXQoImNvbW1fbW9kZSIsInNpbGVudCIpKQogICAgaW50ZXJ2YWwgPSBhcmdzLmludGVydmFsIG9yIGZsb2F0KHNwZWMuZ2V0KCJpbnRlcnZhbCIsMzAwKSkKICAgIGppdHRlciA9IGFyZ3Muaml0dGVyIG9yIGZsb2F0KHNwZWMuZ2V0KCJqaXR0ZXIiLDUpKQogICAgbWF4X2N5Y2xlcyA9IGFyZ3MubWF4X2N5Y2xlcwogICAgaWYgbWF4X2N5Y2xlcyBpcyBub3QgTm9uZSBhbmQgbWF4X2N5Y2xlcyA8IDE6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiLS1tYXgtY3ljbGVzIG11c3QgYmUgPj0gMSIpCiAgICBkZWFkbGluZSA9IGZsb2F0KGFyZ3MuYnVyc3RfZGVhZGxpbmUpIGlmIGFyZ3MuYnVyc3RfZGVhZGxpbmUgaXMgbm90IE5vbmUgZWxzZSAxODAwLjAKICAgIGRlYWRsaW5lX2NhcCA9IGZsb2F0KCdpbmYnKSBpZiBkZWFkbGluZSA8PSAwIGVsc2UgZGVhZGxpbmUKICAgIGlmIGFyZ3MubW9kZT09Im9uY2UiOgogICAgICAgIGN5Y2xlX29uY2UoY29tbV9tb2RlPWNvbW1fbW9kZSkKICAgICAgICByZXR1cm4gMAogICAgYmFja29mZj0xLjAKICAgIGN5Y2xlcz0wCiAgICBzdGFydD10aW1lLnRpbWUoKQogICAgd2hpbGUgVHJ1ZToKICAgICAgICBvdXQ9Y3ljbGVfb25jZShjb21tX21vZGU9Y29tbV9tb2RlKTsgc3RhdHVzPW91dC5nZXQoInN0YXR1cyIpCiAgICAgICAgY3ljbGVzKz0xCiAgICAgICAgaWYgc3RhdHVzPT0iT0siOgogICAgICAgICAgICBiYWNrb2ZmPTEuMAogICAgICAgICAgICBkZWxheT1pbnRlcnZhbCtyYW5kb20udW5pZm9ybSgwLGppdHRlcikKICAgICAgICBlbGlmIHN0YXR1cz09IldBUk4iOgogICAgICAgICAgICBiYWNrb2ZmPW1pbig2MC4wLGJhY2tvZmYqMikKICAgICAgICAgICAgZGVsYXk9bWF4KGludGVydmFsLzIsYmFja29mZikKICAgICAgICBlbHNlOgogICAgICAgICAgICBiYWNrb2ZmPW1pbigxMjAuMCxiYWNrb2ZmKjIpCiAgICAgICAgICAgIGRlbGF5PWJhY2tvZmYKICAgICAgICBpZiBtYXhfY3ljbGVzIGlzIG5vdCBOb25lIGFuZCBjeWNsZXMgPj0gbWF4X2N5Y2xlczoKICAgICAgICAgICAgYnJlYWsKICAgICAgICBlbGFwc2VkPXRpbWUudGltZSgpLXN0YXJ0CiAgICAgICAgaWYgZWxhcHNlZCA+PSBkZWFkbGluZV9jYXA6CiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgc2xlZXBfZm9yPW1heCgwLjEsZGVsYXkpCiAgICAgICAgaWYgZGVhZGxpbmVfY2FwICE9IGZsb2F0KCdpbmYnKToKICAgICAgICAgICAgc2xlZXBfZm9yPW1pbihzbGVlcF9mb3IsbWF4KDAuMSxkZWFkbGluZV9jYXAtZWxhcHNlZCkpCiAgICAgICAgdGltZS5zbGVlcChzbGVlcF9mb3IpCiAgICAgICAgaWYgZGVhZGxpbmVfY2FwICE9IGZsb2F0KCdpbmYnKSBhbmQgKHRpbWUudGltZSgpLXN0YXJ0KSA+PSBkZWFkbGluZV9jYXA6CiAgICAgICAgICAgIGJyZWFrCiAgICByZXR1cm4gMAoKaWYgX19uYW1lX189PSJfX21haW5fXyI6CiAgICBpbXBvcnQgc3lzOyBzeXMuZXhpdChtYWluKCkpCg=="
    },
    {
      "target": "/mnt/data/aci/config/aci_runner_spec.json",
      "mode": "0644",
      "sha256": "9ee6c23c40485c6765716a1a024b50baef41d468babf0518b196a1d001707ef6",
      "encoding": "utf-8",
      "content": "{\n  \"$meta\": {\n    \"artifact_id\": \"ArtifactID:4oci6MbqPmGJ4k\",\n    \"sha256\": \"77f2dd8b081229fee08f06d93025c490bbc94438b50f7825f034541e3d2a6706\",\n    \"issued\": \"2025-10-04T18:13:59Z\",\n    \"path\": \"aci://modules/aci_audit_runner/aci_runner_spec.v0.2.json\"\n  },\n  \"version\": \"0.2\",\n  \"resolvers\": {\n    \"order\": [\n      \"primary\",\n      \"fallback\",\n      \"local\"\n    ],\n    \"primary\": \"https://raw.githubusercontent.com/aliasnet/aci/main\",\n    \"fallback\": \"https://aci.aliasmail.cc\",\n    \"local_root\": \"/mnt/data/aci/local\"\n  },\n  \"resources\": [\n    {\n      \"name\": \"prime_directive\",\n      \"relpath\": \"prime_directive.md\",\n      \"kind\": \"md\"\n    },\n    {\n      \"name\": \"runtime\",\n      \"relpath\": \"runtime.json\",\n      \"kind\": \"json\",\n      \"required_keys\": [\n        \"resolver\"\n      ]\n    },\n    {\n      \"name\": \"functions\",\n      \"relpath\": \"functions.json\",\n      \"kind\": \"json\"\n    },\n    {\n      \"name\": \"metacognition\",\n      \"relpath\": \"library/metacognition/metacognition.json\",\n      \"kind\": \"json\"\n    },\n    {\n      \"name\": \"metacognition_options\",\n      \"relpath\": \"library/metacognition/metacognition_options.json\",\n      \"kind\": \"json\",\n      \"optional\": true\n    },\n    {\n      \"name\": \"yggdrasil\",\n      \"relpath\": \"binders/yggdrasil.json\",\n      \"kind\": \"json\"\n    }\n  ],\n  \"locators_regex\": {\n    \"metacognition\": \"library/metacognition/metacognition(_options)?\\\\.json$\",\n    \"functions\": \"functions(\\\\.registry)?\\\\.json$\",\n    \"yggdrasil\": \"entities/ygg(dr|rd)asil\\\\.json$\",\n    \"prime_directive\": \"prime(_)?directive\\\\.(md|txt)$\"\n  },\n  \"hooks\": {\n    \"self_validation\": [\n      {\n        \"id\": \"rt.resolver.has_primary\",\n        \"select\": \"runtime.resolver.order\",\n        \"assert\": {\n          \"contains\": \"primary\"\n        },\n        \"severity\": \"error\"\n      },\n      {\n        \"id\": \"fx.registry.present\",\n        \"select\": \"functions\",\n        \"assert\": {\n          \"exists\": true\n        },\n        \"severity\": \"error\"\n      }\n    ],\n    \"metacognition\": {\n      \"signals\": [\n        {\n          \"id\": \"digest.delta\",\n          \"type\": \"digest_diff\",\n          \"scope\": [\n            \"runtime\",\n            \"functions\",\n            \"metacognition\",\n            \"yggdrasil\"\n          ]\n        },\n        {\n          \"id\": \"change.rate\",\n          \"type\": \"change_rate\",\n          \"window\": 20,\n          \"threshold_warn\": 4,\n          \"threshold_err\": 8\n        }\n      ]\n    }\n  },\n  \"comm_mode\": \"silent\",\n  \"interval\": 300,\n  \"jitter\": 5,\n  \"recovery\": {\n    \"corpus_id\": \"ACI-RC-20251003-v0.2\",\n    \"path\": \"library/audits/aci_audit_runner/gr_runner_corpus.v0.2.json\",\n    \"sha256\": \"e4c9c6e317b3457bc46cbad6c0d0a151adb9f05f85056a5a8c179595daa4f394\"\n  },\n  \"cadence\": {\n    \"mode\": \"burst\",\n    \"min_cycles\": 1,\n    \"recommended_max_cycles\": 2,\n    \"interval_seconds\": 300,\n    \"jitter_seconds\": 5,\n    \"deadline_seconds\": 1800,\n    \"notes\": \"Use --max-cycles 1 for nominal bursts; extend to 2 only for diagnostics within the 30 minute platform window.\"\n  },\n  \"scheduler_prompt\": {\n    \"summary\": \"Run an ACI audit burst to keep artifacts warm in /mnt/data.\",\n    \"steps\": [\n      \"Ensure /mnt/data/aci/modules/audits/aci_audit_runner/adaptive_audit_runner.py, /mnt/data/aci/logs/, /mnt/data/aci/state/, and /mnt/data/aci/audit/tmp/ exist (create directories if missing).\",\n      \"If the runner is missing, rebuild the JSON-native skeleton from the recovery corpus so each cycle writes state-<UTC>.json, audit-<UTC>.json, and an INFO line to aci-YYYYMMDD.log.\",\n      \"Execute the burst with adaptive spacing, enforce at least one safe iteration, cap the run with --max-cycles 1 (or 2 when debugging), and honor the 1800 second burst deadline.\",\n      \"Hold artifacts locally unless requested; report success with 'Audit burst OK (1 cycle).' or gaps with 'MISSING <path> (tried: github, mirror, local, project)'.\"\n    ],\n    \"command\": \"python /mnt/data/aci/modules/audits/aci_audit_runner/adaptive_audit_runner.py --mode pull --interval 300 --jitter 5 --silent --max-cycles 1 --burst-deadline 1800\",\n    \"success_message\": \"Audit burst OK (1 cycle).\",\n    \"missing_template\": \"MISSING <path> (tried: github, mirror, local, project)\"\n  },\n  \"final_check\": {\n    \"order\": [\n      \"prime_directive.txt|md\",\n      \"runtime.json\",\n      \"entities.json\",\n      \"functions.json\",\n      \"library/metacognition/metacognition.json\",\n      \"library/metacognition/metacognition_options.json\",\n      \"binders/yggdrasil.json\",\n      \"library/audits/aci_audit_runner/aci_runner_spec.v0.2.json\",\n      \"library/audits/aci_audit_runner/gr_runner_corpus.v0.2.json\"\n    ],\n    \"success\": \"Audit burst OK (1 cycle).\",\n    \"on_missing\": \"MISSING <path> (tried: github, mirror, local, project)\"\n  }\n}\n"
    }
  ],
  "restore_instructions": [
    "Create parent dirs if missing.",
    "Write each file atomically; set permissions.",
    "Verify sha256 for each file.",
    "Run: python /mnt/data/aci/modules/audits/aci_audit_runner/adaptive_audit_runner.py --mode once --silent"
  ]
}
