{
  "$meta": {
    "artifact_id": "ArtifactID:BJkqri2Urq9mC8",
    "sha256": "0e8aa9440607d969aa5b4f008b9dc9f4911dc13b83aa92b6efa9ac86d5eb701d",
    "issued": "2025-10-04T18:13:59Z",
    "path": "aci://modules/audits/aci_audit_runner/gr_runner_corpus.v0.2.json"
  },
  "corpus_id": "ACI-RC-20251003-v0.2",
  "created": "2025-10-03T00:00:00Z",
  "files": [
    {
      "target": "/mnt/data/aci/modules/audits/aci_audit_runner/adaptive_audit_runner.py",
      "mode": "0644",
      "sha256": "c58c76c1feed023ff26b5db503be54753a613c4b1fe4a918d90b8f6fa61daae0",
      "encoding": "base64",
      "content": "IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwoiIiIKQUNJIEFkYXB0aXZlIEF1ZGl0IFJ1bm5lciDigJQgdjAuMiAoSlNPTi1uYXRpdmUgd2lyaW5nKQoKLSBKU09OLW5hdGl2ZSBzcGVjIChBQ0kgRFNMKSB0byBkZWZpbmUgcmVzb3VyY2VzLCBsb2NhdG9ycywgaG9va3MsIHNlbGYtdmFsaWRhdGlvbiwgYW5kIG1ldGFjb2duaXRpb24uCi0gUmVnZXgtYmFzZWQgbG9jYXRvciBtYXAgKHRvbGVyYXRlcyBuYW1lIHR5cG9zICYgdmFyaWFudHMpLgotIEhvb2sgbGF5ZXI6IHNlbGYtdmFsaWRhdGlvbiArIG1ldGFjb2duaXRpb24gc2lnbmFscy4KLSBDb21tIG1vZGVzOiBzaWxlbnQgfCBhdWRpdC1vbmx5IHwgbm90aWZ5LW9uLWVycm9yIHwgdmVyYm9zZSAoZGVmYXVsdDogc2lsZW50KS4KLSBBcnRpZmFjdHMgcGVyc2lzdGVkIHVuZGVyIC9tbnQ7IG5vIHN0ZG91dCB1bmxlc3MgdmVyYm9zZS4KClRoaXMgZmlsZSBpcyBhIGxvY2FsIHN0dWIvcnVubmVyIHRoYXQgaW50ZXJwcmV0cyBhIEpTT04gc3BlYyBhdCAvbW50L2RhdGEvYWNpL2NvbmZpZy9hY2lfcnVubmVyX3NwZWMuanNvbgoiIiIKZnJvbSBfX2Z1dHVyZV9fIGltcG9ydCBhbm5vdGF0aW9ucwppbXBvcnQgYXJncGFyc2UsIGNvbnRleHRsaWIsIGRhdGV0aW1lIGFzIF9kdCwganNvbiwgb3MsIHJhbmRvbSwgcmUsIHRocmVhZGluZywgdGltZSwgdXVpZApmcm9tIHR5cGluZyBpbXBvcnQgQW55LCBEaWN0LCBMaXN0LCBPcHRpb25hbCwgVHVwbGUKCkFDSV9ST09UID0gIi9tbnQvZGF0YS9hY2kiCkNBTk9OSUNBTCA9ICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vYWxpYXNuZXQvYWNpL21haW4iCkNETl9GQUxMQkFDSyA9ICJodHRwczovL2FjaS5hbGlhc21haWwuY2MiCkxPQ0FMX1JPT1QgPSBvcy5wYXRoLmpvaW4oQUNJX1JPT1QsICJsb2NhbCIpClNUQVRFX0RJUiA9IG9zLnBhdGguam9pbihBQ0lfUk9PVCwgInN0YXRlIikKQVVESVRfRElSID0gb3MucGF0aC5qb2luKEFDSV9ST09ULCAiYXVkaXQiLCAidG1wIikKTE9HX0RJUiA9IG9zLnBhdGguam9pbihBQ0lfUk9PVCwgImxvZ3MiKQpDT05GSUdfRElSID0gb3MucGF0aC5qb2luKEFDSV9ST09ULCAiY29uZmlnIikKTElCX0RJUiA9IG9zLnBhdGguam9pbihBQ0lfUk9PVCwgIm1vZHVsZXMiLCAiYXVkaXRzIiwgImFjaV9hdWRpdF9ydW5uZXIiKQpTUEVDX1BBVEggPSBvcy5wYXRoLmpvaW4oQ09ORklHX0RJUiwgImFjaV9ydW5uZXJfc3BlYy5qc29uIikKQ09NTV9NT0RFUyA9IHsic2lsZW50IiwgImF1ZGl0LW9ubHkiLCAibm90aWZ5LW9uLWVycm9yIiwgInZlcmJvc2UifQoKZGVmIGVuc3VyZV9zYWZlX3BhdGgocGF0aDogc3RyKSAtPiBzdHI6CiAgICByb290ID0gb3MucGF0aC5yZWFscGF0aChBQ0lfUk9PVCkKICAgIHJlYWwgPSBvcy5wYXRoLnJlYWxwYXRoKHBhdGgpCiAgICBpZiByZWFsICE9IHJvb3QgYW5kIG5vdCByZWFsLnN0YXJ0c3dpdGgocm9vdCArIG9zLnNlcCk6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcihmInVuc2FmZSBwYXRoIG91dHNpZGUge0FDSV9ST09UfToge3BhdGh9IikKICAgIHJldHVybiByZWFsCgpkZWYgc2FmZV9tYWtlZGlycygqcGF0aHM6IHN0cikgLT4gTm9uZToKICAgIGZvciBwIGluIHBhdGhzOgogICAgICAgIG9zLm1ha2VkaXJzKGVuc3VyZV9zYWZlX3BhdGgocCksIGV4aXN0X29rPVRydWUpCgpzYWZlX21ha2VkaXJzKAogICAgQUNJX1JPT1QsCiAgICBMSUJfRElSLAogICAgU1RBVEVfRElSLAogICAgQVVESVRfRElSLAogICAgTE9HX0RJUiwKICAgIExPQ0FMX1JPT1QsCiAgICBDT05GSUdfRElSLAopCgpkZWYgdGltZXN0YW1wX3NsdWcodHM6IE9wdGlvbmFsW3N0cl0gPSBOb25lKSAtPiBzdHI6CiAgICByZWYgPSAodHMgb3Igbm93X3V0YygpKS5yZXBsYWNlKCc6JywgJycpLnJlcGxhY2UoJy0nLCAnJykKICAgIHJldHVybiByZWYKCmRlZiBzYW5pdGl6ZV9yZWxwYXRoKHJlbHBhdGg6IHN0cikgLT4gc3RyOgogICAgbm9ybWFsaXplZCA9IG9zLnBhdGgubm9ybXBhdGgocmVscGF0aCkubHN0cmlwKG9zLnNlcCkKICAgIGlmIG5vcm1hbGl6ZWQuc3RhcnRzd2l0aCgnLi4nKSBvciBvcy5wYXRoLmlzYWJzKHJlbHBhdGgpOgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoZiJpbGxlZ2FsIHJlbHBhdGg6IHtyZWxwYXRofSIpCiAgICByZXR1cm4gbm9ybWFsaXplZAoKd2l0aCBjb250ZXh0bGliLnN1cHByZXNzKEV4Y2VwdGlvbik6CiAgICBpbXBvcnQgcmVxdWVzdHMgICMgdHlwZTogaWdub3JlCgpFUlIgPSB7CiAgICAiU0NIRU1BX01JU1NJTkdfS0VZIjogInNjaGVtYSBtaXNzaW5nIGtleSIsCiAgICAiRkVUQ0hfRkFJTEVEIjogImZldGNoIGZhaWxlZCIsCiAgICAiUkVMQVhFRF9KU09OX1JFQ09WRVJFRCI6ICJyZWxheGVkIGpzb24gcmVjb3ZlcmVkIiwKICAgICJTRUxGX1ZBTElEQVRJT05fRkFJTCI6ICJzZWxmIHZhbGlkYXRpb24gZmFpbGVkIiwKICAgICJNRVRBQ09HX0FOT01BTFkiOiAibWV0YWNvZ25pdGlvbiBhbm9tYWx5IiwKfQoKX0pTT05fVFJBSUxJTkdfQ09NTUFTID0gcmUuY29tcGlsZShyIixccyooW119XSkiKQpfSlNPTl9MSU5FX0NPTU1FTlRTID0gcmUuY29tcGlsZShyIihefFxzKS8vLio/JCIsIHJlLk0pCl9KU09OX0JMT0NLX0NPTU1FTlRTID0gcmUuY29tcGlsZShyIi9cKi4qP1wqLyIsIHJlLlMpCgpkZWYgX3JlbGF4ZWRfanNvbl9ieXRlc190b19vYmooZGF0YTogYnl0ZXMpIC0+IEFueToKICAgIHRleHQgPSBkYXRhLmRlY29kZSgidXRmLTgiLCBlcnJvcnM9InJlcGxhY2UiKQogICAgdGV4dCA9IF9KU09OX0JMT0NLX0NPTU1FTlRTLnN1YigiIiwgdGV4dCkKICAgIHRleHQgPSBfSlNPTl9MSU5FX0NPTU1FTlRTLnN1YigiIiwgdGV4dCkKICAgIHByZXYgPSBOb25lCiAgICB3aGlsZSBwcmV2ICE9IHRleHQ6CiAgICAgICAgcHJldiA9IHRleHQKICAgICAgICAjIGNhbGxhYmxlIHRvIGF2b2lkIGJhY2tyZWYgcGl0ZmFsbHMgd2hlbiBlbWJlZGRpbmcgdGhpcyBzb3VyY2UgZWxzZXdoZXJlCiAgICAgICAgdGV4dCA9IF9KU09OX1RSQUlMSU5HX0NPTU1BUy5zdWIobGFtYmRhIG06IG0uZ3JvdXAoMSksIHRleHQpCiAgICByZXR1cm4ganNvbi5sb2Fkcyh0ZXh0KQoKZGVmIG5vd191dGMoKSAtPiBzdHI6CiAgICByZXR1cm4gX2R0LmRhdGV0aW1lLnV0Y25vdygpLnJlcGxhY2UobWljcm9zZWNvbmQ9MCkuaXNvZm9ybWF0KCkgKyAiWiIKCmRlZiBzaGEyNTYoYjogYnl0ZXMpIC0+IHN0cjoKICAgIGltcG9ydCBoYXNobGliCiAgICByZXR1cm4gaGFzaGxpYi5zaGEyNTYoYikuaGV4ZGlnZXN0KCkKCmRlZiBhdG9taWNfd3JpdGUocGF0aDogc3RyLCBkYXRhOiBieXRlcykgLT4gTm9uZToKICAgIHNhZmVfcGF0aCA9IGVuc3VyZV9zYWZlX3BhdGgocGF0aCkKICAgIHRtcCA9IGYie3NhZmVfcGF0aH0udG1wLXt1dWlkLnV1aWQ0KCkuaGV4fSIKICAgIHdpdGggb3Blbih0bXAsICJ3YiIpIGFzIGY6CiAgICAgICAgZi53cml0ZShkYXRhKQogICAgb3MucmVwbGFjZSh0bXAsIHNhZmVfcGF0aCkKCmRlZiBsb2dfbGluZShtc2c6IHN0ciwgKiwgbGY6IE9wdGlvbmFsW3N0cl0gPSBOb25lLCBjb21tX21vZGU6IHN0ciA9ICJzaWxlbnQiLCBsZXZlbDogc3RyID0gIklORk8iKSAtPiBOb25lOgogICAgdHMgPSBub3dfdXRjKCkKICAgIGxpbmUgPSBmIlt7dHN9XSB7bGV2ZWx9IHttc2d9XG4iCiAgICBsb2dfbmFtZSA9IGVuc3VyZV9zYWZlX3BhdGgobGYgb3Igb3MucGF0aC5qb2luKExPR19ESVIsIF9kdC5kYXRldGltZS51dGNub3coKS5zdHJmdGltZSgiYWNpLSVZJW0lZC5sb2ciKSkpCiAgICB3aXRoIG9wZW4obG9nX25hbWUsICJhIiwgZW5jb2Rpbmc9InV0Zi04IikgYXMgZjoKICAgICAgICBmLndyaXRlKGxpbmUpCiAgICBpZiBjb21tX21vZGUgPT0gInZlcmJvc2UiOgogICAgICAgIHByaW50KGxpbmUsIGVuZD0iIikKClNQRUNfREVGQVVMVCA9IHsKICAgICJ2ZXJzaW9uIjogIjAuMiIsCiAgICAicmVzb2x2ZXJzIjogewogICAgICAgICJvcmRlciI6IFsicHJpbWFyeSIsImZhbGxiYWNrIiwibG9jYWwiXSwKICAgICAgICAicHJpbWFyeSI6IENBTk9OSUNBTCwKICAgICAgICAiZmFsbGJhY2siOiBDRE5fRkFMTEJBQ0ssCiAgICAgICAgImxvY2FsX3Jvb3QiOiBMT0NBTF9ST09UCiAgICB9LAogICAgInJlc291cmNlcyI6IFsKICAgICAgICB7Im5hbWUiOiJwcmltZV9kaXJlY3RpdmUiLCJyZWxwYXRoIjoicHJpbWVfZGlyZWN0aXZlLm1kIiwia2luZCI6Im1kIn0sCiAgICAgICAgeyJuYW1lIjoicnVudGltZSIsInJlbHBhdGgiOiJydW50aW1lLmpzb24iLCJraW5kIjoianNvbiIsInJlcXVpcmVkX2tleXMiOlsicmVzb2x2ZXIiXX0sCiAgICAgICAgeyJuYW1lIjoiZnVuY3Rpb25zIiwicmVscGF0aCI6ImZ1bmN0aW9ucy5qc29uIiwia2luZCI6Impzb24ifSwKICAgICAgICB7Im5hbWUiOiJtZXRhY29nbml0aW9uIiwicmVscGF0aCI6Im1vZHVsZXMvbWV0YWNvZ25pdGlvbi9tZXRhY29nbml0aW9uLmpzb24iLCJraW5kIjoianNvbiJ9LAogICAgICAgIHsibmFtZSI6Im1ldGFjb2duaXRpb25fb3B0aW9ucyIsInJlbHBhdGgiOiJtb2R1bGVzL21ldGFjb2duaXRpb24vbWV0YWNvZ25pdGlvbl9vcHRpb25zLmpzb24iLCJraW5kIjoianNvbiIsIm9wdGlvbmFsIjpUcnVlfSwKICAgICAgICB7Im5hbWUiOiJ5Z2dkcmFzaWwiLCJyZWxwYXRoIjoiYmluZGVycy95Z2dkcmFzaWwuanNvbiIsImtpbmQiOiJqc29uIn0KICAgIF0sCiAgICAibG9jYXRvcnNfcmVnZXgiOiB7CiAgICAgICAgIm1ldGFjb2duaXRpb24iOiAibW9kdWxlcy9tZXRhY29nbml0aW9uL21ldGFjb2duaXRpb24oX29wdGlvbnMpP1xcLmpzb24kIiwKICAgICAgICAiZnVuY3Rpb25zIjogImZ1bmN0aW9ucyhcXC5yZWdpc3RyeSk/XFwuanNvbiQiLAogICAgICAgICJ5Z2dkcmFzaWwiOiAiZW50aXRpZXMveWdnKGRyfHJkKWFzaWxcXC5qc29uJCIsCiAgICAgICAgInByaW1lX2RpcmVjdGl2ZSI6ICJwcmltZShfKT9kaXJlY3RpdmVcXC4obWR8dHh0KSQiCiAgICB9LAogICAgImhvb2tzIjogewogICAgICAgICJzZWxmX3ZhbGlkYXRpb24iOiBbCiAgICAgICAgICAgIHsiaWQiOiJydC5yZXNvbHZlci5oYXNfcHJpbWFyeSIsInNlbGVjdCI6InJ1bnRpbWUucmVzb2x2ZXIub3JkZXIiLCJhc3NlcnQiOnsiY29udGFpbnMiOiJwcmltYXJ5In0sInNldmVyaXR5IjoiZXJyb3IifSwKICAgICAgICAgICAgeyJpZCI6ImZ4LnJlZ2lzdHJ5LnByZXNlbnQiLCJzZWxlY3QiOiJmdW5jdGlvbnMiLCJhc3NlcnQiOnsiZXhpc3RzIjpUcnVlfSwic2V2ZXJpdHkiOiJlcnJvciJ9CiAgICAgICAgXSwKICAgICAgICAibWV0YWNvZ25pdGlvbiI6IHsic2lnbmFscyI6IFsKICAgICAgICAgICAgeyJpZCI6ImRpZ2VzdC5kZWx0YSIsInR5cGUiOiJkaWdlc3RfZGlmZiIsInNjb3BlIjpbInJ1bnRpbWUiLCJmdW5jdGlvbnMiLCJtZXRhY29nbml0aW9uIiwieWdnZHJhc2lsIl19LAogICAgICAgICAgICB7ImlkIjoiY2hhbmdlLnJhdGUiLCJ0eXBlIjoiY2hhbmdlX3JhdGUiLCJ3aW5kb3ciOjIwLCJ0aHJlc2hvbGRfd2FybiI6NCwidGhyZXNob2xkX2VyciI6OH0KICAgICAgICBdfQogICAgfSwKICAgICJjb21tX21vZGUiOiJzaWxlbnQiLCJpbnRlcnZhbCI6MzAwLCJqaXR0ZXIiOjUKfQoKY2xhc3MgUmVzb2x2ZXI6CiAgICBkZWYgX19pbml0X18oc2VsZiwgcHJpbWFyeTogc3RyLCBmYWxsYmFjazogc3RyLCBsb2NhbF9yb290OiBzdHIsIG9yZGVyOiBMaXN0W3N0cl0pOgogICAgICAgIHNlbGYucHJpbWFyeSA9IHByaW1hcnkKICAgICAgICBzZWxmLmZhbGxiYWNrID0gZmFsbGJhY2sKICAgICAgICBzZWxmLmxvY2FsX3Jvb3QgPSBlbnN1cmVfc2FmZV9wYXRoKGxvY2FsX3Jvb3QpCiAgICAgICAgc2VsZi5vcmRlciA9IGxpc3Qob3JkZXIpCiAgICAgICAgc2VsZi5zZXNzaW9uID0gTm9uZQogICAgICAgIHdpdGggY29udGV4dGxpYi5zdXBwcmVzcyhFeGNlcHRpb24pOgogICAgICAgICAgICBpbXBvcnQgcmVxdWVzdHMgYXMgX3IKICAgICAgICAgICAgc2VsZi5zZXNzaW9uID0gX3IuU2Vzc2lvbigpCiAgICBkZWYgX2ZldGNoX2h0dHAoc2VsZiwgdXJsOiBzdHIpIC0+IGJ5dGVzOgogICAgICAgIGlmIHNlbGYuc2Vzc2lvbiBpcyBOb25lOiByYWlzZSBSdW50aW1lRXJyb3IoIm5ldHdvcmsgZGlzYWJsZWQ7IGNhbm5vdCBmZXRjaCByZW1vdGUgVVJMIikKICAgICAgICByID0gc2VsZi5zZXNzaW9uLmdldCh1cmwsIHRpbWVvdXQ9MTIpOyByLnJhaXNlX2Zvcl9zdGF0dXMoKTsgcmV0dXJuIHIuY29udGVudAogICAgZGVmIF9mZXRjaF9sb2NhbChzZWxmLCByZWxwYXRoOiBzdHIpIC0+IGJ5dGVzOgogICAgICAgIGNsZWFuID0gc2FuaXRpemVfcmVscGF0aChyZWxwYXRoKQogICAgICAgIHBhdGggPSBlbnN1cmVfc2FmZV9wYXRoKG9zLnBhdGguam9pbihzZWxmLmxvY2FsX3Jvb3QsIGNsZWFuKSkKICAgICAgICB3aXRoIG9wZW4ocGF0aCwgInJiIikgYXMgZjoKICAgICAgICAgICAgcmV0dXJuIGYucmVhZCgpCiAgICBkZWYgZmV0Y2goc2VsZiwgcmVscGF0aDogc3RyKSAtPiBUdXBsZVtieXRlcywgc3RyLCBzdHJdOgogICAgICAgIGNsZWFuID0gc2FuaXRpemVfcmVscGF0aChyZWxwYXRoKQogICAgICAgIGxhc3RfZXJyPU5vbmUKICAgICAgICBmb3Igc3JjIGluIHNlbGYub3JkZXI6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGlmIHNyYz09InByaW1hcnkiOgogICAgICAgICAgICAgICAgICAgIHVybD1mIntzZWxmLnByaW1hcnl9L3tjbGVhbn0iCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2ZldGNoX2h0dHAodXJsKSwgc3JjLCB1cmwKICAgICAgICAgICAgICAgIGVsaWYgc3JjPT0iZmFsbGJhY2siOgogICAgICAgICAgICAgICAgICAgIHVybD1mIntzZWxmLmZhbGxiYWNrfS97Y2xlYW59IgogICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLl9mZXRjaF9odHRwKHVybCksIHNyYywgdXJsCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGRhdGE9c2VsZi5fZmV0Y2hfbG9jYWwoY2xlYW4pCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEsICJsb2NhbCIsIGYiZmlsZTovL3tzZWxmLmxvY2FsX3Jvb3R9L3tjbGVhbn0iCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIGxhc3RfZXJyPWU7IGNvbnRpbnVlCiAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKGYiQWxsIHJlc29sdmVycyBmYWlsZWQgZm9yIHtjbGVhbn06IHtsYXN0X2Vycn0iKQoKY2xhc3MgUmluZzoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjYXA6aW50PTY0KTogc2VsZi5idWY6TGlzdFtEaWN0W3N0cixBbnldXT1bXTsgc2VsZi5jYXA9Y2FwOyBzZWxmLmxvY2s9dGhyZWFkaW5nLlJMb2NrKCkKICAgIGRlZiBhcHBlbmQoc2VsZix4OkRpY3Rbc3RyLEFueV0pOgogICAgICAgIHdpdGggc2VsZi5sb2NrOgogICAgICAgICAgICBzZWxmLmJ1Zi5hcHBlbmQoeCk7IHNlbGYuYnVmPXNlbGYuYnVmWy1zZWxmLmNhcDpdCiAgICBkZWYgc25hcHNob3Qoc2VsZik6CiAgICAgICAgd2l0aCBzZWxmLmxvY2s6IHJldHVybiBsaXN0KHNlbGYuYnVmKQoKY2xhc3MgQUNJU3RhdGU6CiAgICBkZWYgX19pbml0X18oc2VsZik6IHNlbGYubG9jaz10aHJlYWRpbmcuUkxvY2soKTsgc2VsZi5zdGF0ZTpEaWN0W3N0cixBbnldPXt9OyBzZWxmLm1ldGE6RGljdFtzdHIsQW55XT17fTsgc2VsZi5oaXN0b3J5PVJpbmcoNjQpCiAgICBkZWYgdXBkYXRlKHNlbGYsbmFtZTpzdHIsY29udGVudDpBbnksKixzb3VyY2U6c3RyLHVybDpzdHIsZGlnZXN0OnN0cik6CiAgICAgICAgd2l0aCBzZWxmLmxvY2s6CiAgICAgICAgICAgIHNlbGYuc3RhdGVbbmFtZV09Y29udGVudDsgc2VsZi5tZXRhW25hbWVdPXsidHMiOm5vd191dGMoKSwic291cmNlIjpzb3VyY2UsInVybCI6dXJsLCJzaGEyNTYiOmRpZ2VzdH07CiAgICAgICAgICAgIHNlbGYuaGlzdG9yeS5hcHBlbmQoeyJuYW1lIjpuYW1lLCoqc2VsZi5tZXRhW25hbWVdfSkKICAgIGRlZiBnZXQoc2VsZixwYXRoOnN0ciktPkFueToKICAgICAgICBub2RlOkFueT17KipzZWxmLnN0YXRlfQogICAgICAgIGZvciBwYXJ0IGluIHBhdGguc3BsaXQoJy4nKTogbm9kZSA9IChub2RlLmdldChwYXJ0KSBpZiBpc2luc3RhbmNlKG5vZGUsZGljdCkgZWxzZSBOb25lKQogICAgICAgIHJldHVybiBub2RlCiAgICBkZWYgc25hcHNob3Qoc2VsZiktPkRpY3Rbc3RyLEFueV06CiAgICAgICAgd2l0aCBzZWxmLmxvY2s6IHJldHVybiB7InN0YXRlIjpkaWN0KHNlbGYuc3RhdGUpLCJtZXRhIjpkaWN0KHNlbGYubWV0YSksImhpc3RvcnkiOnNlbGYuaGlzdG9yeS5zbmFwc2hvdCgpLCJ0cyI6bm93X3V0YygpfQoKQUNJX01FTU9SWT1BQ0lTdGF0ZSgpCgpkZWYgd3JpdGVfc3RhdGVfc25hcHNob3QoZmlsZW5hbWU6c3RyPSJhY3RpdmUuanNvbiIpLT5zdHI6CiAgICBzbmFwPUFDSV9NRU1PUlkuc25hcHNob3QoKQogICAgZGF0YT1qc29uLmR1bXBzKHNuYXAsaW5kZW50PTIsZW5zdXJlX2FzY2lpPUZhbHNlKS5lbmNvZGUoInV0Zi04IikKICAgIGFjdGl2ZV9wYXRoPW9zLnBhdGguam9pbihTVEFURV9ESVIsZmlsZW5hbWUpCiAgICBhdG9taWNfd3JpdGUoYWN0aXZlX3BhdGgsZGF0YSkKICAgIHJvdGF0ZWQ9b3MucGF0aC5qb2luKFNUQVRFX0RJUixmInN0YXRlLXt0aW1lc3RhbXBfc2x1ZygpfS5qc29uIikKICAgIGF0b21pY193cml0ZShyb3RhdGVkLGRhdGEpCiAgICByZXR1cm4gYWN0aXZlX3BhdGgKCmRlZiB3cml0ZV9hdWRpdCh0YXNrOnN0cixzdGF0dXM6c3RyLGRldGFpbHM6RGljdFtzdHIsQW55XSktPnN0cjoKICAgIHJlYz17ImpvYl9pZCI6dXVpZC51dWlkNCgpLmhleCwidGFzayI6dGFzaywic3RhdHVzIjpzdGF0dXMsInRzIjpub3dfdXRjKCksImRldGFpbHMiOmRldGFpbHN9CiAgICBkYXRhPWpzb24uZHVtcHMocmVjLGluZGVudD0yLGVuc3VyZV9hc2NpaT1GYWxzZSkuZW5jb2RlKCJ1dGYtOCIpCiAgICBzbHVnPXRpbWVzdGFtcF9zbHVnKHJlY1sidHMiXSkKICAgIGNhbmRpZGF0ZT1mImF1ZGl0LXtzbHVnfS5qc29uIgogICAgcGF0aD1vcy5wYXRoLmpvaW4oQVVESVRfRElSLGNhbmRpZGF0ZSkKICAgIGlmIG9zLnBhdGguZXhpc3RzKGVuc3VyZV9zYWZlX3BhdGgocGF0aCkpOgogICAgICAgIGNhbmRpZGF0ZT1mImF1ZGl0LXtzbHVnfS17cmVjWydqb2JfaWQnXVs6OF19Lmpzb24iCiAgICAgICAgcGF0aD1vcy5wYXRoLmpvaW4oQVVESVRfRElSLGNhbmRpZGF0ZSkKICAgIGF0b21pY193cml0ZShwYXRoLGRhdGEpCiAgICByZXR1cm4gY2FuZGlkYXRlCgpkZWYgbG9hZF9zcGVjKCktPkRpY3Rbc3RyLEFueV06CiAgICB0cnk6CiAgICAgICAgd2l0aCBvcGVuKGVuc3VyZV9zYWZlX3BhdGgoU1BFQ19QQVRIKSwicmIiKSBhcyBmOgogICAgICAgICAgICByZXR1cm4gX3JlbGF4ZWRfanNvbl9ieXRlc190b19vYmooZi5yZWFkKCkpCiAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgIGRhdGE9anNvbi5kdW1wcyhTUEVDX0RFRkFVTFQsaW5kZW50PTIsZW5zdXJlX2FzY2lpPUZhbHNlKS5lbmNvZGUoInV0Zi04IikKICAgICAgICBhdG9taWNfd3JpdGUoU1BFQ19QQVRILGRhdGEpCiAgICAgICAgcmV0dXJuIFNQRUNfREVGQVVMVAoKZGVmIGluZ2VzdF9vbmNlKHNwZWM6RGljdFtzdHIsQW55XSktPkRpY3Rbc3RyLEFueV06CiAgICByZXNfY2ZnPXNwZWNbInJlc291cmNlcyJdOyBvcmRlcj1zcGVjLmdldCgicmVzb2x2ZXJzIix7fSkuZ2V0KCJvcmRlciIsWyJwcmltYXJ5IiwiZmFsbGJhY2siLCJsb2NhbCJdKQogICAgcmVzb2x2ZXI9UmVzb2x2ZXIoc3BlY1sicmVzb2x2ZXJzIl0uZ2V0KCJwcmltYXJ5IixDQU5PTklDQUwpLHNwZWNbInJlc29sdmVycyJdLmdldCgiZmFsbGJhY2siLENETl9GQUxMQkFDSyksc3BlY1sicmVzb2x2ZXJzIl0uZ2V0KCJsb2NhbF9yb290IixMT0NBTF9ST09UKSxvcmRlcikKICAgIHN1bW1hcnk9eyJpbmdlc3RlZCI6W10sICJlcnJvcnMiOltdfQogICAgZm9yIHIgaW4gcmVzX2NmZzoKICAgICAgICByZWxwYXRoPXJbInJlbHBhdGgiXTsga2luZD1yLmdldCgia2luZCIsImpzb24iKTsgcmVxdWlyZWQ9dHVwbGUoci5nZXQoInJlcXVpcmVkX2tleXMiLFtdKSk7IG9wdGlvbmFsPXIuZ2V0KCJvcHRpb25hbCIsRmFsc2UpCiAgICAgICAgdHJ5OgogICAgICAgICAgICByYXcsc3JjLHVybD1yZXNvbHZlci5mZXRjaChyZWxwYXRoKTsgZGlnPXNoYTI1NihyYXcpCiAgICAgICAgICAgIGlmIGtpbmQ9PSJqc29uIjoKICAgICAgICAgICAgICAgIHRyeTogb2JqPWpzb24ubG9hZHMocmF3KQogICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbjogb2JqPV9yZWxheGVkX2pzb25fYnl0ZXNfdG9fb2JqKHJhdykKICAgICAgICAgICAgICAgIGZvciBrIGluIHJlcXVpcmVkOgogICAgICAgICAgICAgICAgICAgIGlmIGsgbm90IGluIG9iajogcmFpc2UgS2V5RXJyb3IoZiJ7RVJSWydTQ0hFTUFfTUlTU0lOR19LRVknXX06IHtrfSIpCiAgICAgICAgICAgICAgICBBQ0lfTUVNT1JZLnVwZGF0ZShyWyJuYW1lIl0sb2JqLHNvdXJjZT1zcmMsdXJsPXVybCxkaWdlc3Q9ZGlnKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdGV4dD1yYXcuZGVjb2RlKCJ1dGYtOCIsZXJyb3JzPSJyZXBsYWNlIik7IEFDSV9NRU1PUlkudXBkYXRlKHJbIm5hbWUiXSx0ZXh0LHNvdXJjZT1zcmMsdXJsPXVybCxkaWdlc3Q9ZGlnKQogICAgICAgICAgICBzdW1tYXJ5WyJpbmdlc3RlZCJdLmFwcGVuZCh7Im5hbWUiOnJbIm5hbWUiXSwidXJsIjp1cmwsInNvdXJjZSI6c3JjLCJzaGEyNTYiOmRpZ30pCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBpZiBvcHRpb25hbDogc3VtbWFyeVsiaW5nZXN0ZWQiXS5hcHBlbmQoeyJuYW1lIjpyWyJuYW1lIl0sIm9wdGlvbmFsX21pc3NpbmciOlRydWV9KTsgY29udGludWUKICAgICAgICAgICAgc3VtbWFyeVsiZXJyb3JzIl0uYXBwZW5kKHsibmFtZSI6clsibmFtZSJdLCJlcnJvciI6c3RyKGUpfSkKICAgIHJldHVybiBzdW1tYXJ5CgpkZWYgX2Fzc2VydF9ldmFsKHNlbGVjdG9yX3ZhbDpBbnksc3BlYzpEaWN0W3N0cixBbnldKS0+T3B0aW9uYWxbc3RyXToKICAgIGlmICJleGlzdHMiIGluIHNwZWM6CiAgICAgICAgd2FudD1ib29sKHNwZWNbImV4aXN0cyJdKTsgZ290PXNlbGVjdG9yX3ZhbCBpcyBub3QgTm9uZQogICAgICAgIGlmIGdvdCE9d2FudDogcmV0dXJuIGYiZXhpc3RzIGV4cGVjdGVkIHt3YW50fSwgZ290IHtnb3R9IgogICAgaWYgImVxdWFscyIgaW4gc3BlYzoKICAgICAgICBpZiBzZWxlY3Rvcl92YWwhPXNwZWNbImVxdWFscyJdOiByZXR1cm4gZiJlcXVhbHMgZXhwZWN0ZWQge3NwZWNbJ2VxdWFscyddfSwgZ290IHtzZWxlY3Rvcl92YWx9IgogICAgaWYgImNvbnRhaW5zIiBpbiBzcGVjOgogICAgICAgIHY9c3BlY1siY29udGFpbnMiXQogICAgICAgIHRyeToKICAgICAgICAgICAgaWYgdiBub3QgaW4gc2VsZWN0b3JfdmFsOiByZXR1cm4gZiJjb250YWlucyBleHBlY3RlZCB7dn0sIG5vdCBpbiB7c2VsZWN0b3JfdmFsfSIKICAgICAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgICAgICByZXR1cm4gZiJjb250YWlucyBub3QtYXBwbGljYWJsZSBmb3Ige3R5cGUoc2VsZWN0b3JfdmFsKS5fX25hbWVfX30iCiAgICBpZiAicmVnZXgiIGluIHNwZWM6CiAgICAgICAgcGF0PXJlLmNvbXBpbGUoc3BlY1sicmVnZXgiXSk7IHRleHQ9anNvbi5kdW1wcyhzZWxlY3Rvcl92YWwsZW5zdXJlX2FzY2lpPUZhbHNlKSBpZiBub3QgaXNpbnN0YW5jZShzZWxlY3Rvcl92YWwsc3RyKSBlbHNlIHNlbGVjdG9yX3ZhbAogICAgICAgIGlmIG5vdCBwYXQuc2VhcmNoKHRleHQgb3IgIiIpOiByZXR1cm4gZiJyZWdleCB7c3BlY1sncmVnZXgnXX0gZGlkIG5vdCBtYXRjaCIKICAgIHJldHVybiBOb25lCgpkZWYgcnVuX3NlbGZfdmFsaWRhdGlvbihzcGVjOkRpY3Rbc3RyLEFueV0pLT5EaWN0W3N0cixBbnldOgogICAgY2hlY2tzPXNwZWMuZ2V0KCJob29rcyIse30pLmdldCgic2VsZl92YWxpZGF0aW9uIixbXSk7IGZhaWx1cmVzOkxpc3RbRGljdFtzdHIsQW55XV09W10KICAgIGZvciBjIGluIGNoZWNrczoKICAgICAgICBzZWw9Yy5nZXQoInNlbGVjdCIsIiIpOyB2YWw9QUNJX01FTU9SWS5nZXQoc2VsKSBpZiBzZWwgZWxzZSBOb25lOyBlcnI9X2Fzc2VydF9ldmFsKHZhbCxjLmdldCgiYXNzZXJ0Iix7fSkpCiAgICAgICAgaWYgZXJyOiBmYWlsdXJlcy5hcHBlbmQoeyJpZCI6Yy5nZXQoImlkIiksInNlbGVjdCI6c2VsLCJyZWFzb24iOmVyciwic2V2ZXJpdHkiOmMuZ2V0KCJzZXZlcml0eSIsIndhcm4iKX0pCiAgICByZXR1cm4geyJmYWlsdXJlcyI6ZmFpbHVyZXMsICJwYXNzZWQiOmxlbihmYWlsdXJlcyk9PTB9CgpkZWYgcnVuX21ldGFjb2duaXRpb24oc3BlYzpEaWN0W3N0cixBbnldKS0+RGljdFtzdHIsQW55XToKICAgIHNpZ25hbHNfY2ZnPXNwZWMuZ2V0KCJob29rcyIse30pLmdldCgibWV0YWNvZ25pdGlvbiIse30pLmdldCgic2lnbmFscyIsW10pOyBzaWduYWxzOkxpc3RbRGljdFtzdHIsQW55XV09W10KICAgIGhpc3Rvcnk9QUNJX01FTU9SWS5oaXN0b3J5LnNuYXBzaG90KCkKICAgIGZvciBzIGluIHNpZ25hbHNfY2ZnOgogICAgICAgIHNpZD1zLmdldCgiaWQiKTsgc3R5cGU9cy5nZXQoInR5cGUiKQogICAgICAgIGlmIHN0eXBlPT0iZGlnZXN0X2RpZmYiOgogICAgICAgICAgICBzY29wZT1zLmdldCgic2NvcGUiLFtdKTsgZGlmZnM9e30KICAgICAgICAgICAgZm9yIG5hbWUgaW4gc2NvcGU6CiAgICAgICAgICAgICAgICBwcmV2PU5vbmUKICAgICAgICAgICAgICAgIGZvciBoIGluIHJldmVyc2VkKGhpc3RvcnkpOgogICAgICAgICAgICAgICAgICAgIGlmIGguZ2V0KCJuYW1lIik9PW5hbWU6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHByZXYgaXMgTm9uZTogcHJldj1oLmdldCgic2hhMjU2IikKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZTogZGlmZnNbbmFtZV09eyJuZXciOnByZXYsIm9sZCI6aC5nZXQoInNoYTI1NiIpLCJjaGFuZ2VkIjpwcmV2IT1oLmdldCgic2hhMjU2Iil9OyBicmVhawogICAgICAgICAgICBzaWduYWxzLmFwcGVuZCh7ImlkIjpzaWQsInR5cGUiOnN0eXBlLCJkaWZmcyI6ZGlmZnN9KQogICAgICAgIGVsaWYgc3R5cGU9PSJjaGFuZ2VfcmF0ZSI6CiAgICAgICAgICAgIHdpbmRvdz1pbnQocy5nZXQoIndpbmRvdyIsMjApKTsgdHc9aW50KHMuZ2V0KCJ0aHJlc2hvbGRfd2FybiIsNCkpOyB0ZT1pbnQocy5nZXQoInRocmVzaG9sZF9lcnIiLDgpKQogICAgICAgICAgICB3aW5kb3dfaGlzdD1oaXN0b3J5Wy13aW5kb3c6XTsgY2hhbmdlcz17fQogICAgICAgICAgICBmb3IgaCBpbiB3aW5kb3dfaGlzdDoKICAgICAgICAgICAgICAgIG5tPWguZ2V0KCJuYW1lIik7IGNoYW5nZXNbbm1dPWNoYW5nZXMuZ2V0KG5tLDApKzEKICAgICAgICAgICAgbXg9bWF4KGNoYW5nZXMudmFsdWVzKCkpIGlmIGNoYW5nZXMgZWxzZSAwCiAgICAgICAgICAgIGxldmVsID0gImVyciIgaWYgbXg+PXRlIGVsc2UgKCJ3YXJuIiBpZiBteD49dHcgZWxzZSAib2siKQogICAgICAgICAgICBzaWduYWxzLmFwcGVuZCh7ImlkIjpzaWQsInR5cGUiOnN0eXBlLCJsZXZlbCI6bGV2ZWwsIm1heF9jaGFuZ2VzIjpteCwiYnlfbmFtZSI6Y2hhbmdlc30pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2lnbmFscy5hcHBlbmQoeyJpZCI6c2lkLCJ0eXBlIjpzdHlwZSwibm90ZSI6InVua25vd24gc2lnbmFsIHR5cGUifSkKICAgIEFDSV9NRU1PUlkubWV0YS5zZXRkZWZhdWx0KCJtZXRhY29nbml0aW9uIix7fSk7IEFDSV9NRU1PUlkubWV0YVsibWV0YWNvZ25pdGlvbiJdWyJ0cyJdPW5vd191dGMoKTsgQUNJX01FTU9SWS5tZXRhWyJtZXRhY29nbml0aW9uIl1bInNpZ25hbHMiXT1zaWduYWxzCiAgICByZXR1cm4geyJzaWduYWxzIjpzaWduYWxzfQoKZGVmIGN5Y2xlX29uY2UoY29tbV9tb2RlOnN0cj0ic2lsZW50IiktPkRpY3Rbc3RyLEFueV06CiAgICBzcGVjPWxvYWRfc3BlYygpOyBzdW1tYXJ5PWluZ2VzdF9vbmNlKHNwZWMpOyBzZWxmdj1ydW5fc2VsZl92YWxpZGF0aW9uKHNwZWMpOyBtZXRhPXJ1bl9tZXRhY29nbml0aW9uKHNwZWMpCiAgICB3cml0ZV9zdGF0ZV9zbmFwc2hvdCgpOyBzdGF0dXMgPSAiT0siIGlmIChub3Qgc3VtbWFyeVsiZXJyb3JzIl0gYW5kIHNlbGZ2WyJwYXNzZWQiXSkgZWxzZSAoIldBUk4iIGlmIHNlbGZ2WyJwYXNzZWQiXSBlbHNlICJFUlIiKQogICAgZGV0YWlscz17ImluZ2VzdGVkIjpzdW1tYXJ5WyJpbmdlc3RlZCJdLCJlcnJvcnMiOnN1bW1hcnlbImVycm9ycyJdLCJzZWxmX3ZhbGlkYXRpb24iOnNlbGZ2LCJtZXRhY29nbml0aW9uIjptZXRhfQogICAgbmFtZT13cml0ZV9hdWRpdCgiYXVkaXQuY3ljbGUiLHN0YXR1cyxkZXRhaWxzKTsgbG9nX2xpbmUoZiJjeWNsZSBzdGF0dXM9e3N0YXR1c30gLT4ge25hbWV9Iixjb21tX21vZGU9Y29tbV9tb2RlKQogICAgaWYgY29tbV9tb2RlIGluIHsiYXVkaXQtb25seSIsIm5vdGlmeS1vbi1lcnJvciJ9IGFuZCBzdGF0dXM9PSJFUlIiOiBsb2dfbGluZSgiRVJST1IgZGV0ZWN0ZWQg4oCUIGNoZWNrIGF1ZGl0IGZpbGUgZm9yIGRldGFpbHMiLGNvbW1fbW9kZT1jb21tX21vZGUsbGV2ZWw9IkVSUk9SIikKICAgIHJldHVybiB7InN0YXR1cyI6c3RhdHVzLCJhdWRpdCI6bmFtZX0KCmRlZiBidWlsZF9hcmdwYXJzZXIoKS0+YXJncGFyc2UuQXJndW1lbnRQYXJzZXI6CiAgICBwPWFyZ3BhcnNlLkFyZ3VtZW50UGFyc2VyKGRlc2NyaXB0aW9uPSJBQ0kgQWRhcHRpdmUgQXVkaXQgUnVubmVyIChKU09OLW5hdGl2ZSkiKQogICAgcC5hZGRfYXJndW1lbnQoIi0tbW9kZSIsY2hvaWNlcz1bInB1bGwiLCJvbmNlIl0sZGVmYXVsdD0icHVsbCIpCiAgICBwLmFkZF9hcmd1bWVudCgiLS1pbnRlcnZhbCIsdHlwZT1mbG9hdCxkZWZhdWx0PU5vbmUsaGVscD0iUHVsbCBpbnRlcnZhbCBzZWNvbmRzIikKICAgIHAuYWRkX2FyZ3VtZW50KCItLWppdHRlciIsdHlwZT1mbG9hdCxkZWZhdWx0PU5vbmUsaGVscD0iUmFuZG9tIGppdHRlciBhZGRlZCB0byBpbnRlcnZhbCIpCiAgICBwLmFkZF9hcmd1bWVudCgiLS1jb21tIixjaG9pY2VzPWxpc3QoQ09NTV9NT0RFUyksZGVmYXVsdD1Ob25lLGhlbHA9IkNvbW11bmljYXRpb24gbW9kZSIpCiAgICBwLmFkZF9hcmd1bWVudCgiLS1zaWxlbnQiLGFjdGlvbj0ic3RvcmVfdHJ1ZSIsaGVscD0iQWxpYXMgZm9yIC0tY29tbSBzaWxlbnQiKQogICAgcC5hZGRfYXJndW1lbnQoIi0tbWF4LWN5Y2xlcyIsdHlwZT1pbnQsZGVmYXVsdD1Ob25lLGhlbHA9Ik1heGltdW0gbnVtYmVyIG9mIHB1bGwgY3ljbGVzIGJlZm9yZSBleGl0aW5nICg+PTEpIikKICAgIHAuYWRkX2FyZ3VtZW50KCItLWJ1cnN0LWRlYWRsaW5lIix0eXBlPWZsb2F0LGRlZmF1bHQ9MTgwMC4wLGhlbHA9IlVwcGVyIGJvdW5kIGluIHNlY29uZHMgZm9yIGEgcHVsbCBidXJzdCBiZWZvcmUgZXhpdCIpCiAgICByZXR1cm4gcAoKZGVmIG1haW4oYXJndjpPcHRpb25hbFtMaXN0W3N0cl1dPU5vbmUpLT5pbnQ6CiAgICBhcmdzPWJ1aWxkX2FyZ3BhcnNlcigpLnBhcnNlX2FyZ3MoYXJndikKICAgIHNwZWM9bG9hZF9zcGVjKCkKICAgIGNvbW1fbW9kZSA9ICJzaWxlbnQiIGlmIGFyZ3Muc2lsZW50IGVsc2UgKGFyZ3MuY29tbSBvciBzcGVjLmdldCgiY29tbV9tb2RlIiwic2lsZW50IikpCiAgICBpbnRlcnZhbCA9IGFyZ3MuaW50ZXJ2YWwgb3IgZmxvYXQoc3BlYy5nZXQoImludGVydmFsIiwzMDApKQogICAgaml0dGVyID0gYXJncy5qaXR0ZXIgb3IgZmxvYXQoc3BlYy5nZXQoImppdHRlciIsNSkpCiAgICBtYXhfY3ljbGVzID0gYXJncy5tYXhfY3ljbGVzCiAgICBpZiBtYXhfY3ljbGVzIGlzIG5vdCBOb25lIGFuZCBtYXhfY3ljbGVzIDwgMToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCItLW1heC1jeWNsZXMgbXVzdCBiZSA+PSAxIikKICAgIGRlYWRsaW5lID0gZmxvYXQoYXJncy5idXJzdF9kZWFkbGluZSkgaWYgYXJncy5idXJzdF9kZWFkbGluZSBpcyBub3QgTm9uZSBlbHNlIDE4MDAuMAogICAgZGVhZGxpbmVfY2FwID0gZmxvYXQoJ2luZicpIGlmIGRlYWRsaW5lIDw9IDAgZWxzZSBkZWFkbGluZQogICAgaWYgYXJncy5tb2RlPT0ib25jZSI6CiAgICAgICAgY3ljbGVfb25jZShjb21tX21vZGU9Y29tbV9tb2RlKQogICAgICAgIHJldHVybiAwCiAgICBiYWNrb2ZmPTEuMAogICAgY3ljbGVzPTAKICAgIHN0YXJ0PXRpbWUudGltZSgpCiAgICB3aGlsZSBUcnVlOgogICAgICAgIG91dD1jeWNsZV9vbmNlKGNvbW1fbW9kZT1jb21tX21vZGUpOyBzdGF0dXM9b3V0LmdldCgic3RhdHVzIikKICAgICAgICBjeWNsZXMrPTEKICAgICAgICBpZiBzdGF0dXM9PSJPSyI6CiAgICAgICAgICAgIGJhY2tvZmY9MS4wCiAgICAgICAgICAgIGRlbGF5PWludGVydmFsK3JhbmRvbS51bmlmb3JtKDAsaml0dGVyKQogICAgICAgIGVsaWYgc3RhdHVzPT0iV0FSTiI6CiAgICAgICAgICAgIGJhY2tvZmY9bWluKDYwLjAsYmFja29mZioyKQogICAgICAgICAgICBkZWxheT1tYXgoaW50ZXJ2YWwvMixiYWNrb2ZmKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGJhY2tvZmY9bWluKDEyMC4wLGJhY2tvZmYqMikKICAgICAgICAgICAgZGVsYXk9YmFja29mZgogICAgICAgIGlmIG1heF9jeWNsZXMgaXMgbm90IE5vbmUgYW5kIGN5Y2xlcyA+PSBtYXhfY3ljbGVzOgogICAgICAgICAgICBicmVhawogICAgICAgIGVsYXBzZWQ9dGltZS50aW1lKCktc3RhcnQKICAgICAgICBpZiBlbGFwc2VkID49IGRlYWRsaW5lX2NhcDoKICAgICAgICAgICAgYnJlYWsKICAgICAgICBzbGVlcF9mb3I9bWF4KDAuMSxkZWxheSkKICAgICAgICBpZiBkZWFkbGluZV9jYXAgIT0gZmxvYXQoJ2luZicpOgogICAgICAgICAgICBzbGVlcF9mb3I9bWluKHNsZWVwX2ZvcixtYXgoMC4xLGRlYWRsaW5lX2NhcC1lbGFwc2VkKSkKICAgICAgICB0aW1lLnNsZWVwKHNsZWVwX2ZvcikKICAgICAgICBpZiBkZWFkbGluZV9jYXAgIT0gZmxvYXQoJ2luZicpIGFuZCAodGltZS50aW1lKCktc3RhcnQpID49IGRlYWRsaW5lX2NhcDoKICAgICAgICAgICAgYnJlYWsKICAgIHJldHVybiAwCgppZiBfX25hbWVfXz09Il9fbWFpbl9fIjoKICAgIGltcG9ydCBzeXM7IHN5cy5leGl0KG1haW4oKSkK"
    },
    {
      "target": "/mnt/data/aci/config/aci_runner_spec.json",
      "mode": "0644",
      "sha256": "9da30a0d65eb283f4dc8eb0046e3774406367d1726b7e8fff05eb44dd28307bf",
      "encoding": "utf-8",
      "content": "ewogICIkbWV0YSI6IHsKICAgICJhcnRpZmFjdF9pZCI6ICJBcnRpZmFjdElEOjRvY2k2TWJxUG1HSjRrIiwKICAgICJzaGEyNTYiOiAiMTI2NDE0ZDU2MTM3NTgwZmY5OTMwODdmYmQ5NTYwZGU3OGRkMTc3MjFhNTcyMDQzYzAyNzAzZGQyYzYxY2NlNyIsCiAgICAiaXNzdWVkIjogIjIwMjUtMTAtMDRUMTg6MTM6NTlaIiwKICAgICJwYXRoIjogImFjaTovL21vZHVsZXMvYXVkaXRzL2FjaV9hdWRpdF9ydW5uZXIvYWNpX3J1bm5lcl9zcGVjLnYwLjIuanNvbiIKICB9LAogICJ2ZXJzaW9uIjogIjAuMiIsCiAgInJlc29sdmVycyI6IHsKICAgICJvcmRlciI6IFsKICAgICAgInByaW1hcnkiLAogICAgICAiZmFsbGJhY2siLAogICAgICAibG9jYWwiCiAgICBdLAogICAgInByaW1hcnkiOiAiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2FsaWFzbmV0L2FjaS9tYWluIiwKICAgICJmYWxsYmFjayI6ICJodHRwczovL2FjaS5hbGlhc21haWwuY2MiLAogICAgImxvY2FsX3Jvb3QiOiAiL21udC9kYXRhL2FjaS9sb2NhbCIKICB9LAogICJyZXNvdXJjZXMiOiBbCiAgICB7CiAgICAgICJuYW1lIjogInByaW1lX2RpcmVjdGl2ZSIsCiAgICAgICJyZWxwYXRoIjogInByaW1lX2RpcmVjdGl2ZS5tZCIsCiAgICAgICJraW5kIjogIm1kIgogICAgfSwKICAgIHsKICAgICAgIm5hbWUiOiAicnVudGltZSIsCiAgICAgICJyZWxwYXRoIjogInJ1bnRpbWUuanNvbiIsCiAgICAgICJraW5kIjogImpzb24iLAogICAgICAicmVxdWlyZWRfa2V5cyI6IFsKICAgICAgICAicmVzb2x2ZXIiCiAgICAgIF0KICAgIH0sCiAgICB7CiAgICAgICJuYW1lIjogImZ1bmN0aW9ucyIsCiAgICAgICJyZWxwYXRoIjogImZ1bmN0aW9ucy5qc29uIiwKICAgICAgImtpbmQiOiAianNvbiIKICAgIH0sCiAgICB7CiAgICAgICJuYW1lIjogIm1ldGFjb2duaXRpb24iLAogICAgICAicmVscGF0aCI6ICJtb2R1bGVzL21ldGFjb2duaXRpb24vbWV0YWNvZ25pdGlvbi5qc29uIiwKICAgICAgImtpbmQiOiAianNvbiIKICAgIH0sCiAgICB7CiAgICAgICJuYW1lIjogIm1ldGFjb2duaXRpb25fb3B0aW9ucyIsCiAgICAgICJyZWxwYXRoIjogIm1vZHVsZXMvbWV0YWNvZ25pdGlvbi9tZXRhY29nbml0aW9uX29wdGlvbnMuanNvbiIsCiAgICAgICJraW5kIjogImpzb24iLAogICAgICAib3B0aW9uYWwiOiB0cnVlCiAgICB9LAogICAgewogICAgICAibmFtZSI6ICJ5Z2dkcmFzaWwiLAogICAgICAicmVscGF0aCI6ICJiaW5kZXJzL3lnZ2RyYXNpbC5qc29uIiwKICAgICAgImtpbmQiOiAianNvbiIKICAgIH0KICBdLAogICJsb2NhdG9yc19yZWdleCI6IHsKICAgICJtZXRhY29nbml0aW9uIjogIm1vZHVsZXMvbWV0YWNvZ25pdGlvbi9tZXRhY29nbml0aW9uKF9vcHRpb25zKT9cXC5qc29uJCIsCiAgICAiZnVuY3Rpb25zIjogImZ1bmN0aW9ucyhcXC5yZWdpc3RyeSk/XFwuanNvbiQiLAogICAgInlnZ2RyYXNpbCI6ICJlbnRpdGllcy95Z2coZHJ8cmQpYXNpbFxcLmpzb24kIiwKICAgICJwcmltZV9kaXJlY3RpdmUiOiAicHJpbWUoXyk/ZGlyZWN0aXZlXFwuKG1kfHR4dCkkIgogIH0sCiAgImhvb2tzIjogewogICAgInNlbGZfdmFsaWRhdGlvbiI6IFsKICAgICAgewogICAgICAgICJpZCI6ICJydC5yZXNvbHZlci5oYXNfcHJpbWFyeSIsCiAgICAgICAgInNlbGVjdCI6ICJydW50aW1lLnJlc29sdmVyLm9yZGVyIiwKICAgICAgICAiYXNzZXJ0IjogewogICAgICAgICAgImNvbnRhaW5zIjogInByaW1hcnkiCiAgICAgICAgfSwKICAgICAgICAic2V2ZXJpdHkiOiAiZXJyb3IiCiAgICAgIH0sCiAgICAgIHsKICAgICAgICAiaWQiOiAiZngucmVnaXN0cnkucHJlc2VudCIsCiAgICAgICAgInNlbGVjdCI6ICJmdW5jdGlvbnMiLAogICAgICAgICJhc3NlcnQiOiB7CiAgICAgICAgICAiZXhpc3RzIjogdHJ1ZQogICAgICAgIH0sCiAgICAgICAgInNldmVyaXR5IjogImVycm9yIgogICAgICB9CiAgICBdLAogICAgIm1ldGFjb2duaXRpb24iOiB7CiAgICAgICJzaWduYWxzIjogWwogICAgICAgIHsKICAgICAgICAgICJpZCI6ICJkaWdlc3QuZGVsdGEiLAogICAgICAgICAgInR5cGUiOiAiZGlnZXN0X2RpZmYiLAogICAgICAgICAgInNjb3BlIjogWwogICAgICAgICAgICAicnVudGltZSIsCiAgICAgICAgICAgICJmdW5jdGlvbnMiLAogICAgICAgICAgICAibWV0YWNvZ25pdGlvbiIsCiAgICAgICAgICAgICJ5Z2dkcmFzaWwiCiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAiaWQiOiAiY2hhbmdlLnJhdGUiLAogICAgICAgICAgInR5cGUiOiAiY2hhbmdlX3JhdGUiLAogICAgICAgICAgIndpbmRvdyI6IDIwLAogICAgICAgICAgInRocmVzaG9sZF93YXJuIjogNCwKICAgICAgICAgICJ0aHJlc2hvbGRfZXJyIjogOAogICAgICAgIH0KICAgICAgXQogICAgfQogIH0sCiAgImNvbW1fbW9kZSI6ICJzaWxlbnQiLAogICJpbnRlcnZhbCI6IDMwMCwKICAiaml0dGVyIjogNSwKICAicmVjb3ZlcnkiOiB7CiAgICAiY29ycHVzX2lkIjogIkFDSS1SQy0yMDI1MTAwMy12MC4yIiwKICAgICJwYXRoIjogIm1vZHVsZXMvYXVkaXRzL2FjaV9hdWRpdF9ydW5uZXIvZ3JfcnVubmVyX2NvcnB1cy52MC4yLmpzb24iLAogICAgInNoYTI1NiI6ICJlNGM5YzZlMzE3YjM0NTdiYzQ2Y2JhZDZjMGQwYTE1MWFkYjlmMDVmODUwNTZhNWE4YzE3OTU5NWRhYTRmMzk0IgogIH0sCiAgImNhZGVuY2UiOiB7CiAgICAibW9kZSI6ICJidXJzdCIsCiAgICAibWluX2N5Y2xlcyI6IDEsCiAgICAicmVjb21tZW5kZWRfbWF4X2N5Y2xlcyI6IDIsCiAgICAiaW50ZXJ2YWxfc2Vjb25kcyI6IDMwMCwKICAgICJqaXR0ZXJfc2Vjb25kcyI6IDUsCiAgICAiZGVhZGxpbmVfc2Vjb25kcyI6IDE4MDAsCiAgICAibm90ZXMiOiAiVXNlIC0tbWF4LWN5Y2xlcyAxIGZvciBub21pbmFsIGJ1cnN0czsgZXh0ZW5kIHRvIDIgb25seSBmb3IgZGlhZ25vc3RpY3Mgd2l0aGluIHRoZSAzMCBtaW51dGUgcGxhdGZvcm0gd2luZG93LiIKICB9LAogICJzY2hlZHVsZXJfcHJvbXB0IjogewogICAgInN1bW1hcnkiOiAiUnVuIGFuIEFDSSBhdWRpdCBidXJzdCB0byBrZWVwIGFydGlmYWN0cyB3YXJtIGluIC9tbnQvZGF0YS4iLAogICAgInN0ZXBzIjogWwogICAgICAiRW5zdXJlIC9tbnQvZGF0YS9hY2kvbW9kdWxlcy9hdWRpdHMvYWNpX2F1ZGl0X3J1bm5lci9hZGFwdGl2ZV9hdWRpdF9ydW5uZXIucHksIC9tbnQvZGF0YS9hY2kvbG9ncy8sIC9tbnQvZGF0YS9hY2kvc3RhdGUvLCBhbmQgL21udC9kYXRhL2FjaS9hdWRpdC90bXAvIGV4aXN0IChjcmVhdGUgZGlyZWN0b3JpZXMgaWYgbWlzc2luZykuIiwKICAgICAgIklmIHRoZSBydW5uZXIgaXMgbWlzc2luZywgcmVidWlsZCB0aGUgSlNPTi1uYXRpdmUgc2tlbGV0b24gZnJvbSB0aGUgcmVjb3ZlcnkgY29ycHVzIHNvIGVhY2ggY3ljbGUgd3JpdGVzIHN0YXRlLTxVVEM+Lmpzb24sIGF1ZGl0LTxVVEM+Lmpzb24sIGFuZCBhbiBJTkZPIGxpbmUgdG8gYWNpLVlZWVlNTURELmxvZy4iLAogICAgICAiRXhlY3V0ZSB0aGUgYnVyc3Qgd2l0aCBhZGFwdGl2ZSBzcGFjaW5nLCBlbmZvcmNlIGF0IGxlYXN0IG9uZSBzYWZlIGl0ZXJhdGlvbiwgY2FwIHRoZSBydW4gd2l0aCAtLW1heC1jeWNsZXMgMSAob3IgMiB3aGVuIGRlYnVnZ2luZyksIGFuZCBob25vciB0aGUgMTgwMCBzZWNvbmQgYnVyc3QgZGVhZGxpbmUuIiwKICAgICAgIkhvbGQgYXJ0aWZhY3RzIGxvY2FsbHkgdW5sZXNzIHJlcXVlc3RlZDsgcmVwb3J0IHN1Y2Nlc3Mgd2l0aCAnQXVkaXQgYnVyc3QgT0sgKDEgY3ljbGUpLicgb3IgZ2FwcyB3aXRoICdNSVNTSU5HIDxwYXRoPiAodHJpZWQ6IGdpdGh1YiwgbWlycm9yLCBsb2NhbCwgcHJvamVjdCknLiIKICAgIF0sCiAgICAiY29tbWFuZCI6ICJweXRob24gL21udC9kYXRhL2FjaS9tb2R1bGVzL2F1ZGl0cy9hY2lfYXVkaXRfcnVubmVyL2FkYXB0aXZlX2F1ZGl0X3J1bm5lci5weSAtLW1vZGUgcHVsbCAtLWludGVydmFsIDMwMCAtLWppdHRlciA1IC0tc2lsZW50IC0tbWF4LWN5Y2xlcyAxIC0tYnVyc3QtZGVhZGxpbmUgMTgwMCIsCiAgICAic3VjY2Vzc19tZXNzYWdlIjogIkF1ZGl0IGJ1cnN0IE9LICgxIGN5Y2xlKS4iLAogICAgIm1pc3NpbmdfdGVtcGxhdGUiOiAiTUlTU0lORyA8cGF0aD4gKHRyaWVkOiBnaXRodWIsIG1pcnJvciwgbG9jYWwsIHByb2plY3QpIgogIH0sCiAgImZpbmFsX2NoZWNrIjogewogICAgIm9yZGVyIjogWwogICAgICAicHJpbWVfZGlyZWN0aXZlLnR4dHxtZCIsCiAgICAgICJydW50aW1lLmpzb24iLAogICAgICAiZW50aXRpZXMuanNvbiIsCiAgICAgICJmdW5jdGlvbnMuanNvbiIsCiAgICAgICJtb2R1bGVzL21ldGFjb2duaXRpb24vbWV0YWNvZ25pdGlvbi5qc29uIiwKICAgICAgIm1vZHVsZXMvbWV0YWNvZ25pdGlvbi9tZXRhY29nbml0aW9uX29wdGlvbnMuanNvbiIsCiAgICAgICJiaW5kZXJzL3lnZ2RyYXNpbC5qc29uIiwKICAgICAgIm1vZHVsZXMvYXVkaXRzL2FjaV9hdWRpdF9ydW5uZXIvYWNpX3J1bm5lcl9zcGVjLnYwLjIuanNvbiIsCiAgICAgICJtb2R1bGVzL2F1ZGl0cy9hY2lfYXVkaXRfcnVubmVyL2dyX3J1bm5lcl9jb3JwdXMudjAuMi5qc29uIgogICAgXSwKICAgICJzdWNjZXNzIjogIkF1ZGl0IGJ1cnN0IE9LICgxIGN5Y2xlKS4iLAogICAgIm9uX21pc3NpbmciOiAiTUlTU0lORyA8cGF0aD4gKHRyaWVkOiBnaXRodWIsIG1pcnJvciwgbG9jYWwsIHByb2plY3QpIgogIH0KfQ=="
    }
  ],
  "restore_instructions": [
    "Create parent dirs if missing.",
    "Write each file atomically; set permissions.",
    "Verify sha256 for each file.",
    "Run: python /mnt/data/aci/modules/audits/aci_audit_runner/adaptive_audit_runner.py --mode once --silent"
  ]
}